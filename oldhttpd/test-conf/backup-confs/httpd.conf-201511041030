# ###########################################################
# nuinfo apache httpd.conf file
# ###########################################################
#
# Read the notes on related files and changing the configuration below
#
# Do not edit the production configuration directly;
# the master copies are in /nuinfo/httpd/test-conf
#
# 5/17/99 this now contains conditional directives
# for tests on port 8002 and includes virtual
# hosts from another file in httpd/test-conf
# 2/3/00 srm.conf and access.conf consolidated into httpd.conf

# conditional symbols brought in from local scripts:
# TESTSERVER - run a test server on port 8002
# TESTVERSION - running the test version binary symlinked as httpd-test
# APACHE2 - test or production server is Apache 2.x
# NOAGENT - if configuration for Sun WAM agent should not be included
# MIRROR - configuration for chnuinfo mirror host
# MCACHE - enable mod_mem_cache caching of select images and styles
# DEFLATE - enable mod_deflate for on-the fly compression filter
# WWWV5 - indicates older "www-v5" top-menus being replaced Aug 2009
# ENOTICE - scheme for posting emergency notices to replace the home page
# ----------------------------------------------
# symbols to support the Red Hat Linux cluster:
# VERSION to introduce mod_version into the configuration for 2.0.x and 2.2.x
# APACHE22 - using Apache 2.2.x - use with APACHE2 defined too
# CLUSTER - any Red Hat cluster node
# Hhostname - to specify the specific node, this determines the IP we listen to
# ROTATELOGS - pipe Apache logs to the rotatelogs program
# ----------------------------------------------
# Symbols for per-host differences in the Linux cluster
#
# IfDefine    node      fqdn                        ip address
# symbol      number
# HEVNUINFOW1 01    evnuinfow1.it.northwestern.edu  129.105.215.152
# HEVNUINFOW2 02    evnuinfow2.it.northwestern.edu  129.105.215.153
# HEVNUINFOW3 03    evnuinfow3.it.northwestern.edu  129.105.215.154
# HCHNUINFOW1 04    chnuinfow1.it.northwestern.edu  165.124.65.30
# HCHNUINFOW2 05    chnuinfow2.it.northwestern.edu  165.124.65.31
# HCHNUINFOW3 06    chnuinfow3.it.northwestern.edu  165.124.65.32
#
#             90    nuinfo.northwestern.edu         129.105.16.72
# MIRROR      91    chnuinfo.northwestern.edu       165.124.67.10
# ----------------------------------------------
# Apache Environment variables:
#
# NODENUMBER is a two-digit number as above
# NODENAME is the unqualified hostname, like: evnuinfow1
# NODEFQDN is the full DNS name like: evnuinfow1.it.northwestern.edu
# ----------------------------------------------
# Configuration and log directories:
#
# (Mostly I'm prefixing "test-" to the production directory names)
# Directories   production                                  test
#
#---------------------------------------
# nuinfo
# logs:         /nuinfo/current-logs/httpd/log              /nuinfo/current-logs/httpd/test-logs
# logs history: /logs/old/httpd                             not rotated
# config:       /nuinfo/httpd/conf                          /nuinfo/httpd/test-conf
# am config:    /etc/opt/SUNWam/agents/apache/config/_prod  /etc/opt/SUNWam/agents/apache/config/_test
# am log:       /logs/cur/sunwam/logs/amAgent               /logs/cur/sunwam/test-logs/amAgent
# am history:   /logs/old/sunwam/prod                       /logs/old/sunwam/test
# server root:  /nuinfo/httpd                               /nuinfo/httpd
# pid file:     /nuinfo/current-logs/httpd/logs/httpd.pid   /nuinfo/current-logs/httpd/test-logs/httpd.pid
#
#---------------------------------------
# chnuinfo
# logs:         /nuinfo/current-logs/httpd/log              /nuinfo/current-logs/httpd/test-logs
# logs history: /logs/old/httpd                             not rotated
# config:       /nuinfo/httpd/conf                          /nuinfo/httpd/test-conf
# am config:    /etc/opt/SUNWam/agents/apache/config/_prod  /etc/opt/SUNWam/agents/apache/config/_test
# am log:       /logs/cur/sunwam/logs/amAgent               /logs/cur/sunwam/test-logs/amAgent
# am history:   /logs/old/sunwam/prod                       /logs/old/sunwam/test
# server root:  /nuinfo/httpd                               /nuinfo/httpd
# pid file:     /nuinfo/current-logs/httpd/logs/httpd.pid   /nuinfo/current-logs/httpd/test-logs/httpd.pid
#
#---------------------------------------
# cluster
# logs:         /var/log/httpd                             /var/log/test-httpd
# logs history: /logs/old/httpd                            /logs/old/test-httpd
# config:       /etc/httpd/conf                             /etc/httpd/test-conf
#
# am config:    /var/local/web_agents/apache22_agent/Agent_001/config/AMAgent.properties production
#               /var/local/web_agents/apache22_agent/Agent_002/config/AMAgent.properties test
#
# am log:       /var/log/amagent/amagent_log.txt            /var/log/test-amagent/amagent_log.txt
# am history:   /logs/old/amagent                           /logs/old/test-amagent
# server root:  /etc/httpd/                                 /etc/httpd/
# pid file:     /var/run/httpd.pid                          /var/run/test-httpd.pid
#
# ----------------------------------------------
#
# Conditional symbols are specified in three files
# /nuinfo/httpd/conf/apache-options                 for production port 80
# /nuinfo/httpd/test-conf/apache-options            for test port 8002
# /nuinfo/httpd/test-conf/test-httpd-apache-options for test port 8002 with the httpd-test binary

# ----------------------------------------------
# Related Apache configuration files included below are:
#
# main-only.conf    directives that apply only to the main host
#                   or near clones of it
#
# main-head.conf    configuration that only applies to the
#                   main host and not its clones (plus
#                   some things that needed to be up front)
#
# virtual.conf      virtual host configuration
#
# virtual-redirect.conf redirects of virtual host document roots under htdocs
#                       included into the main host configuration
#
# mime.types            the usual Apache MIME type mapping file
#
# Other configuration files:
#
# policy-url-file.txt   List of URLs for which Access Manager should be turned on
#                       (Used to build the inverted "not enforced list" via
#                       a java program.)
#
# virtual-host-map.txt  List of virtual hosts used by nuinfo stats
#                       and access manager (to define the list of valid host names)
#
# am_template_test.properties           template for test access manager config
#
# am_template_prod.properties           template for production access manager config
#
# am_template_test_mirror.properties    template for test access manager config on the mirror
#
# am_template_prod_mirror.properties    template for production access manager config on the mirror
#
#(It will rarely be necessqary to edit these templates. They are not synchronized
# automatically with chninfo. Having four templates allows for setting
# different logging options and access manager server failover rules )
#
# /nuinfo/httpd/virtual-host-options/host-list  list of virtual hosts
#                                               used to create robots.txt
#
# all-names.conf    sanity-check URL testing rules
#
# ----------------------------------------------
# A make file exists to stage configurations to test and production.
#
# You will need /local-adm/bin in your path to follow these instructions
#
#   I say "tcsh" then "source /nuinfo/lunde/setup"
#   to set up my path and terminal settings
#
# Go to /nuinfo/httpd/test-conf/
#
# Run ./save_current_conf to backup the current configuration.
#
# Edit the copies of the files in /nuinfo/httpd/test-conf/
#
# Run "start-test-web-server-current-httpd" to start a
# test server on port 8002.
#
# "./diff-conf" checks and compares the test and production configurations
#
# Run "make test" to install a test configuration for
# both Apache and access manager on port 8002.
#
# Run "make install" to install a production configuration on port 80
#
# Run "make test-mirror" to reconfigure the test server on the chnuinfo mirror
#
# Run "make install-mirror" to reconfigure the production server on the chnuinfo mirror
#
# Run ./save_current_conf again to backup the new configuration.
#
# (A script removes references to port 8002 in the virtual host configs)
#
# You should be running a test server before trying to install
# a production configuration. One of the sanity checks run
# on "make install" looks at the response of various URLs on
# port 8002, and will block a production install if that test fails.
#
# The list of URLs checked is in all-names.conf. You might
# have to comment out a line there when redirecting one of
# these URLs.
#
# Doing "make install" may kill the test server on port 8002 if
# a full restart is required (this is done if a quicker restart fails)
#
# The nightly log rotation cron job also kills the port 8002 test host
#
# when creating virtual hosts it is desirable to also create the
# document root directly on the chnuinfo mirror, if it does not exist
# ----------------------------------------------
#

# Listen is required in Apache 2.0/2.2, replacing Port
# add explict IP to avoid Ipv6 errors 11-5-06
# add chnuinfo mirror IP 12-14-07
# add cluster web nodes 9-2011

<IfDefine !TESTSERVER>
    # port 80, production port case, all servers
    <IfDefine !CLUSTER>
        <IfDefine !MIRROR>
            # nuinfo
            Listen 129.105.16.72:80
        </IfDefine>
        <IfDefine MIRROR>
            # chnuinfo
            Listen 165.124.67.10:80
        </IfDefine>

        # end if not cluster
    </IfDefine>

    <IfDefine CLUSTER>
        # Listen for cluster nodes, production port 80
        <IfDefine HEVNUINFOW1>
            Listen 129.105.215.152:80
        </IfDefine>
        <IfDefine HEVNUINFOW2>
            Listen 129.105.215.153:80
        </IfDefine>
        <IfDefine HEVNUINFOW3>
            Listen 129.105.215.154:80
        </IfDefine>
        <IfDefine HCHNUINFOW1>
            Listen 165.124.65.30:80
        </IfDefine>
        <IfDefine HCHNUINFOW2>
            Listen 165.124.65.31:80
        </IfDefine>
        <IfDefine HCHNUINFOW3>
            Listen 165.124.65.32:80
        </IfDefine>

        # end if cluster
    </IfDefine>

    <IfDefine CLUSTER>
        # alternative:
        # Listen to all interfaces production port 80
        # Listen 80

        # end if cluster
    </IfDefine>

    # end if port 80
</IfDefine>

<IfDefine TESTSERVER>
    # port 8002, test port case, all servers
    <IfDefine !CLUSTER>
        <IfDefine !MIRROR>
            # nuinfo
            Listen 129.105.16.72:8002
        </IfDefine>
        <IfDefine MIRROR>
            # chnuinfo
            Listen 165.124.67.10:8002
        </IfDefine>

        # end if not cluster
    </IfDefine>

    <IfDefine CLUSTER>
        # Listen for cluster nodes IPs, test port 8002
        <IfDefine HEVNUINFOW1>
            Listen 129.105.215.152:8002
        </IfDefine>
        <IfDefine HEVNUINFOW2>
            Listen 129.105.215.153:8002
        </IfDefine>
        <IfDefine HEVNUINFOW3>
            Listen 129.105.215.154:8002
        </IfDefine>
        <IfDefine HCHNUINFOW1>
            Listen 165.124.65.30:8002
        </IfDefine>
        <IfDefine HCHNUINFOW2>
            Listen 165.124.65.31:8002
        </IfDefine>
        <IfDefine HCHNUINFOW3>
            Listen 165.124.65.32:8002
        </IfDefine>

        # end if cluster
    </IfDefine>

    <IfDefine CLUSTER>
        # alternative:
        # Listen to all interfaces test port 8002
        # Listen 8002

        # end if cluster
    </IfDefine>

    # end if port 8002
</IfDefine>

<IfDefine CLUSTER>

    # On Linux listen on IPv4 / IPv6 localhost
    # Ports 80 or 8002
    # (This is not needed if we listen on all interfaces)

    <IfDefine !TESTSERVER>
         # port 80 production

        # IPv4 localhost:
        Listen 127.0.0.1:80

        # IPv6 localhost/loopback address is ::1
        Listen [::1]:80
    </IfDefine>

    <IfDefine TESTSERVER>
        # port 80 test

        # IPv4 localhost:
        Listen 127.0.0.1:8002

        # IPv6 localhost/loopback address is ::1
        Listen [::1]:8002
    </IfDefine>

    # end if Apache 2.2.x
</IfDefine>


# ServerRoot: The directory the server's config, error, and log files
# are kept in

#  We don't specify ServerRoot for Apache2 to in order use
#  compiled-in per-version/build ServerRoot values 8-16-06
#  This lets us load modules from several builds on nuinfo/chnuinfo

# conditional defines, environment var to flag chicago mirror 12-12-07
# (add -DMIRROR to apache-options on mirror)

# 9-2011 Wherever I use !MIRROR vs MIRROR
# add "<IfDefine !CLUSTER>" for nuinfo/chnuinfo
#     "<IfDefine CLUSTER>"  for cluster nodes
# cases where "<IfDefine TESTSERVER>" appears also need
# to be broken out because of the different directory layout

# - - - - -
# Shared module support is now only defined for Apache 2, where it is required
# I've dumped the legacy Apache 1.3.x configs

# However, for Apache 2.2.x define both APACHE2 _and_ APACHE22
# because of legacy stuff that may be left elsewhere from Apache 1.3.x days

# production version of httpd binaries
# (this logic is not about port 80 vs port 8002)
<IfDefine !TESTVERSION>

    <IfDefine APACHE22>

        # Apache 2.2 module names

        # imitate idmapp, for a start, comment out stuff we don't need
        LoadModule auth_basic_module modules/mod_auth_basic.so
        #LoadModule auth_digest_module modules/mod_auth_digest.so
        LoadModule authn_file_module modules/mod_authn_file.so
        #LoadModule authn_alias_module modules/mod_authn_alias.so
        #LoadModule authn_anon_module modules/mod_authn_anon.so
        #LoadModule authn_dbm_module modules/mod_authn_dbm.so
        LoadModule authn_default_module modules/mod_authn_default.so
        LoadModule authz_host_module modules/mod_authz_host.so
        LoadModule authz_user_module modules/mod_authz_user.so
        #LoadModule authz_owner_module modules/mod_authz_owner.so
        LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
        #LoadModule authz_dbm_module modules/mod_authz_dbm.so
        LoadModule authz_default_module modules/mod_authz_default.so
        #LoadModule ldap_module modules/mod_ldap.so
        #LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
        LoadModule include_module modules/mod_include.so
        LoadModule log_config_module modules/mod_log_config.so
        <IfDefine LOGIO>
            LoadModule logio_module modules/mod_logio.so
        </IfDefine>
            LoadModule env_module modules/mod_env.so
        <IfDefine EXTFILTER>
            LoadModule ext_filter_module modules/mod_ext_filter.so
        </IfDefine>
        #LoadModule mime_magic_module modules/mod_mime_magic.so
        LoadModule expires_module modules/mod_expires.so
        <IfDefine DEFLATE>
            LoadModule deflate_module modules/mod_deflate.so
        </IfDefine>
        LoadModule headers_module modules/mod_headers.so
        #LoadModule usertrack_module modules/mod_usertrack.so
        LoadModule setenvif_module modules/mod_setenvif.so
        LoadModule mime_module modules/mod_mime.so
        #LoadModule dav_module modules/mod_dav.so
        LoadModule status_module modules/mod_status.so
        LoadModule autoindex_module modules/mod_autoindex.so
        LoadModule info_module modules/mod_info.so
        #LoadModule dav_fs_module modules/mod_dav_fs.so
        #LoadModule vhost_alias_module modules/mod_vhost_alias.so
        LoadModule negotiation_module modules/mod_negotiation.so
        LoadModule dir_module modules/mod_dir.so
        LoadModule actions_module modules/mod_actions.so
        LoadModule speling_module modules/mod_speling.so
        LoadModule userdir_module modules/mod_userdir.so
        # the imagemap module is required
        LoadModule imagemap_module modules/mod_imagemap.so
        LoadModule alias_module modules/mod_alias.so
        LoadModule rewrite_module modules/mod_rewrite.so
        #LoadModule proxy_module modules/mod_proxy.so
        #LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
        #LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
        #LoadModule proxy_http_module modules/mod_proxy_http.so
        #LoadModule proxy_connect_module modules/mod_proxy_connect.so
        <IfDefine MCACHE>
            LoadModule cache_module modules/mod_cache.so
        </IfDefine>
        #LoadModule suexec_module modules/mod_suexec.so
        #LoadModule disk_cache_module modules/mod_disk_cache.so
        #LoadModule file_cache_module modules/mod_file_cache.so
        <IfDefine MCACHE>
            LoadModule mem_cache_module modules/mod_mem_cache.so
        </IfDefine>
        LoadModule cgi_module modules/mod_cgi.so
        <IfDefine VERSION>
            LoadModule version_module modules/mod_version.so
        </IfDefine>

    </IfDefine>

    <IfDefine !APACHE22>
        # Apache 2 shared module support
        # revise this list when adding/removing modules
        LoadModule access_module modules/mod_access.so
        LoadModule auth_module modules/mod_auth.so
        <IfDefine MCACHE>
            # memory cache modules
            LoadModule cache_module modules/mod_cache.so
            LoadModule mem_cache_module modules/mod_mem_cache.so
        </IfDefine>
        <IfDefine EXTFILTER>
            LoadModule ext_filter_module modules/mod_ext_filter.so
        </IfDefine>
        LoadModule include_module modules/mod_include.so
        <IfDefine DEFLATE>
            # content compression on the fly filter module
            # (position relative to mod_include may matter)
            LoadModule deflate_module modules/mod_deflate.so
        </IfDefine>
        LoadModule log_config_module modules/mod_log_config.so
        <IfDefine LOGIO>
            LoadModule logio_module modules/mod_logio.so
        </IfDefine>
        LoadModule env_module modules/mod_env.so
        LoadModule expires_module modules/mod_expires.so
        LoadModule headers_module modules/mod_headers.so
        LoadModule unique_id_module modules/mod_unique_id.so
        <IfDefine VERSION>
            LoadModule version_module modules/mod_version.so
        </IfDefine>
        LoadModule setenvif_module modules/mod_setenvif.so
        LoadModule mime_module modules/mod_mime.so
        LoadModule status_module modules/mod_status.so
        LoadModule autoindex_module modules/mod_autoindex.so
        LoadModule asis_module modules/mod_asis.so
        LoadModule info_module modules/mod_info.so
        LoadModule cgi_module modules/mod_cgi.so
        LoadModule negotiation_module modules/mod_negotiation.so
        LoadModule dir_module modules/mod_dir.so
        LoadModule imap_module modules/mod_imap.so
        LoadModule actions_module modules/mod_actions.so
        LoadModule speling_module modules/mod_speling.so
        LoadModule userdir_module modules/mod_userdir.so
        LoadModule alias_module modules/mod_alias.so
        LoadModule rewrite_module modules/mod_rewrite.so
    </IfDefine>

    # end if not TESTVERSION
</IfDefine>

# test "version" of httpd binaries (whatever that means)

# This logic exists to support testing new builds of httpd
# with a different compiled-in ServerRoot and modules
# relative to that directory
#
# This was the main way we introduced new binary builds
# on Solaris
<IfDefine TESTVERSION>

    <IfDefine APACHE22>

        # For apache 2.2.x define APACHE2 _and_ APACHE22

        # Apache 2.2 module names

        # imitate idmapp, for a start, comment out stuff we don't need
        LoadModule auth_basic_module modules/mod_auth_basic.so
        #LoadModule auth_digest_module modules/mod_auth_digest.so
        LoadModule authn_file_module modules/mod_authn_file.so
        #LoadModule authn_alias_module modules/mod_authn_alias.so
        #LoadModule authn_anon_module modules/mod_authn_anon.so
        #LoadModule authn_dbm_module modules/mod_authn_dbm.so
        LoadModule authn_default_module modules/mod_authn_default.so
        LoadModule authz_host_module modules/mod_authz_host.so
        LoadModule authz_user_module modules/mod_authz_user.so
        #LoadModule authz_owner_module modules/mod_authz_owner.so
        LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
        #LoadModule authz_dbm_module modules/mod_authz_dbm.so
        LoadModule authz_default_module modules/mod_authz_default.so
        #LoadModule ldap_module modules/mod_ldap.so
        #LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
        LoadModule include_module modules/mod_include.so
        LoadModule log_config_module modules/mod_log_config.so
        <IfDefine LOGIO>
            LoadModule logio_module modules/mod_logio.so
        </IfDefine>
            LoadModule env_module modules/mod_env.so
        <IfDefine EXTFILTER>
            LoadModule ext_filter_module modules/mod_ext_filter.so
        </IfDefine>
        #LoadModule mime_magic_module modules/mod_mime_magic.so
        LoadModule expires_module modules/mod_expires.so
        <IfDefine DEFLATE>
            LoadModule deflate_module modules/mod_deflate.so
        </IfDefine>
        LoadModule headers_module modules/mod_headers.so
        #LoadModule usertrack_module modules/mod_usertrack.so
        LoadModule setenvif_module modules/mod_setenvif.so
        LoadModule mime_module modules/mod_mime.so
        #LoadModule dav_module modules/mod_dav.so
        LoadModule status_module modules/mod_status.so
        LoadModule autoindex_module modules/mod_autoindex.so
        LoadModule info_module modules/mod_info.so
        #LoadModule dav_fs_module modules/mod_dav_fs.so
        #LoadModule vhost_alias_module modules/mod_vhost_alias.so
        LoadModule negotiation_module modules/mod_negotiation.so
        LoadModule dir_module modules/mod_dir.so
        LoadModule actions_module modules/mod_actions.so
        LoadModule speling_module modules/mod_speling.so
        LoadModule userdir_module modules/mod_userdir.so
        # the imagemap module is required
        LoadModule imagemap_module modules/mod_imagemap.so
        LoadModule alias_module modules/mod_alias.so
        LoadModule rewrite_module modules/mod_rewrite.so
        #LoadModule proxy_module modules/mod_proxy.so
        #LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
        #LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
        #LoadModule proxy_http_module modules/mod_proxy_http.so
        #LoadModule proxy_connect_module modules/mod_proxy_connect.so
        <IfDefine MCACHE>
            LoadModule cache_module modules/mod_cache.so
        </IfDefine>
        #LoadModule suexec_module modules/mod_suexec.so
        #LoadModule disk_cache_module modules/mod_disk_cache.so
        #LoadModule file_cache_module modules/mod_file_cache.so
        <IfDefine MCACHE>
            LoadModule mem_cache_module modules/mod_mem_cache.so
        </IfDefine>
        LoadModule cgi_module modules/mod_cgi.so
        <IfDefine VERSION>
            LoadModule version_module modules/mod_version.so
        </IfDefine>

    </IfDefine>

    <IfDefine !APACHE22>

        # Apache 2.0 module names

        # revise this list when adding/removing modules
        LoadModule access_module modules/mod_access.so
        LoadModule auth_module modules/mod_auth.so
        <IfDefine MCACHE>
           # memory cache modules
            LoadModule cache_module modules/mod_cache.so
            LoadModule mem_cache_module modules/mod_mem_cache.so
        </IfDefine>
        <IfDefine EXTFILTER>
            LoadModule ext_filter_module modules/mod_ext_filter.so
        </IfDefine>
        LoadModule include_module modules/mod_include.so
        <IfDefine DEFLATE>
            # content compression on the fly filter module
            # (position relative to mod_include may matter)
            LoadModule deflate_module modules/mod_deflate.so
        </IfDefine>
        LoadModule log_config_module modules/mod_log_config.so
        <IfDefine LOGIO>
            LoadModule logio_module modules/mod_logio.so
        </IfDefine>
        LoadModule env_module modules/mod_env.so
        LoadModule expires_module modules/mod_expires.so
        LoadModule headers_module modules/mod_headers.so
        LoadModule unique_id_module modules/mod_unique_id.so
        <IfDefine VERSION>
            LoadModule version_module modules/mod_version.so
        </IfDefine>
        LoadModule setenvif_module modules/mod_setenvif.so
        LoadModule mime_module modules/mod_mime.so
        LoadModule status_module modules/mod_status.so
        LoadModule autoindex_module modules/mod_autoindex.so
        LoadModule asis_module modules/mod_asis.so
        LoadModule info_module modules/mod_info.so
        LoadModule cgi_module modules/mod_cgi.so
        LoadModule negotiation_module modules/mod_negotiation.so
        LoadModule dir_module modules/mod_dir.so
        LoadModule imap_module modules/mod_imap.so
        LoadModule actions_module modules/mod_actions.so
        LoadModule speling_module modules/mod_speling.so
        LoadModule userdir_module modules/mod_userdir.so
        LoadModule alias_module modules/mod_alias.so
        LoadModule rewrite_module modules/mod_rewrite.so
    </IfDefine>

# end if TESTVERSION
</IfDefine>
# - - - - -

#---------------------------------------
# This section needs to go after the LoadModule directives on Linux
#---------------------------------------
# SSI booleans
# note: SSIs treat non-null as true, so use "" as false, "1" as true
#
<IfDefine !CLUSTER>
    # main host / nuinfo
    <IfDefine !MIRROR>
        SetEnv ON_MIRROR    ""
        SetEnv ON_MAINHOST  "1"
        SetEnv ON_CLUSTER   ""
    </IfDefine>

    # chicago mirror / chnuinfo
    <IfDefine MIRROR>
        SetEnv ON_MIRROR    "1"
        SetEnv ON_MAINHOST  ""
        SetEnv ON_CLUSTER   ""
    </IfDefine>

    # end if not cluster
</IfDefine>

# Linux cluster node
<IfDefine CLUSTER>
    SetEnv ON_MIRROR    ""
    # for backwards compatability:
    SetEnv ON_MAINHOST  "1"
    SetEnv ON_CLUSTER   "1"

    #end if cluster
</IfDefine>
#---------------------------------------


#---------------------------------------
# symbols for per-host differences in the Linux cluster
#
# IfDefine    node      fqdn                        ip address
# symbol      number
# HEVNUINFOW1 01    evnuinfow1.it.northwestern.edu  129.105.215.152
# HEVNUINFOW2 02    evnuinfow2.it.northwestern.edu  129.105.215.153
# HEVNUINFOW3 03    evnuinfow3.it.northwestern.edu  129.105.215.154
# HCHNUINFOW1 04    chnuinfow1.it.northwestern.edu  165.124.65.30
# HCHNUINFOW2 05    chnuinfow2.it.northwestern.edu  165.124.65.31
# HCHNUINFOW3 06    chnuinfow3.it.northwestern.edu  165.124.65.32
#
#             90    nuinfo.northwestern.edu         129.105.16.72
# MIRROR      91    chnuinfo.northwestern.edu       165.124.67.10
#---------------------------------------
# arbitrary node number, short name, and FQDN environment variables
# for logging, file paths, etc. if needed
<IfDefine CLUSTER>
    <IfDefine HEVNUINFOW1>
        SetEnv NODENUMBER "01"
        SetEnv NODENAME "evnuinfow1"
        SetEnv NODEFQDN "evnuinfow1.it.northwestern.edu"
    </IfDefine>
    <IfDefine HEVNUINFOW2>
        SetEnv NODENUMBER "02"
        SetEnv NODENAME "evnuinfow2"
        SetEnv NODEFQDN "evnuinfow2.it.northwestern.edu"
    </IfDefine>
    <IfDefine HEVNUINFOW3>
        SetEnv NODENUMBER "03"
        SetEnv NODENAME "evnuinfow3"
        SetEnv NODEFQDN "evnuinfow3.it.northwestern.edu"
    </IfDefine>
    <IfDefine HCHNUINFOW1>
        SetEnv NODENUMBER "04"
        SetEnv NODENAME "chnuinfow1"
        SetEnv NODEFQDN "chnuinfow1.it.northwestern.edu"
    </IfDefine>
    <IfDefine HCHNUINFOW2>
        SetEnv NODENUMBER "05"
        SetEnv NODENAME "chnuinfow2"
        SetEnv NODEFQDN "chnuinfow2.it.northwestern.edu"
    </IfDefine>
    <IfDefine HCHNUINFOW3>
        SetEnv NODENUMBER "06"
        SetEnv NODENAME "chnuinfow3"
        SetEnv NODEFQDN "chnuinfow3.it.northwestern.edu"
    </IfDefine>

    # end if cluster
</IfDefine>

# Define node numbers 90, 91 for nuinfo/chnuinfo,
# they will probably not much used in practice
<IfDefine !CLUSTER>
    <IfDefine !MIRROR>
        # nuinfo
        SetEnv NODENUMBER "90"
        SetEnv NODENAME "nuinfo"
        SetEnv NODEFQDN "nuinfo.northwestern.edu"
    </IfDefine>

    <IfDefine MIRROR>
        # chnuinfo
        SetEnv NODENUMBER "91"
        SetEnv NODENAME "chnuinfo"
        SetEnv NODEFQDN "chnuinfo.northwestern.edu"
    </IfDefine>

    # end if not cluster
</IfDefine>
#---------------------------------------

# port 8002 test server runs as webtest, files under httpd/test-conf


# symbols for per-host differences in the Linux cluster
#
# IfDefine    node      fqdn                        ip address
# symbol      number
# HEVNUINFOW1 01    evnuinfow1.it.northwestern.edu  129.105.215.152
# HEVNUINFOW2 02    evnuinfow2.it.northwestern.edu  129.105.215.153
# HEVNUINFOW3 03    evnuinfow3.it.northwestern.edu  129.105.215.154
# HCHNUINFOW1 04    chnuinfow1.it.northwestern.edu  165.124.65.30
# HCHNUINFOW2 05    chnuinfow2.it.northwestern.edu  165.124.65.31
# HCHNUINFOW3 06    chnuinfow3.it.northwestern.edu  165.124.65.32
#
#             90    nuinfo.northwestern.edu         129.105.16.72
# MIRROR      91    chnuinfo.northwestern.edu       165.124.67.10



# Listen moved up front to fix Linux issues 9-29-11

<IfDefine !TESTSERVER>
</IfDefine>

<IfDefine TESTSERVER>
</IfDefine>


# If you wish httpd to run as a different user or group, you must run
# httpd as root initially and it will switch.

# User/Group: The name (or #number) of the user/group to run httpd as.

<IfDefine !TESTSERVER>
    User  webserv
    Group webserv
</IfDefine>

<IfDefine TESTSERVER>
    User  webtest
    Group webserv
</IfDefine>

# ServerAdmin: Your address, where problems with the server should be
# e-mailed.

ServerAdmin webmaster@northwestern.edu

# changes to go from 1.2.6 to 1.3.3 here:

# add second LogLevel for testing 8-16-06
# LogLevel introduced in 1.3
<IfDefine !TESTSERVER>
    LogLevel info
</IfDefine>

<IfDefine TESTSERVER>
    # debug logging causes too much traffic on port 8002 on the cluster 1-14-2012
    # LogLevel debug
    LogLevel info
</IfDefine>


# Turn on DNS lookups for our stats again for 1.3, default is now off
HostNameLookups on

# ExtendedStatus Added in 1.3.2
ExtendedStatus on

# 1-8-02 move all logs to directories under /nuinfo/current-logs/httpd

# ErrorLog: The location of the error log file. If this does not start
# with /, ServerRoot is prepended to it.

<IfDefine !CLUSTER>
    # nuinfo/chnuinfo
    <IfDefine !TESTSERVER>
        ErrorLog /nuinfo/current-logs/httpd/logs/error_log
    </IfDefine>

    <IfDefine TESTSERVER>
        ErrorLog /nuinfo/current-logs/httpd/test-logs/error_log
    </IfDefine>

    # end if not cluster
</IfDefine>

# Note: The error log for the cluster is defined below

# TransferLog: The location of the transfer log file. If this does not
# start with /, ServerRoot is prepended to it.

# LogFormat "%v %h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-agent}i\""

# revised to help host name logging 3/8/00
#LogFormat "%V %h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-agent}i\""

# give nuinfo log format a nickname to help define custom logs 12-16-06
LogFormat "%V %h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-agent}i\"" vhost_plus_combined

LogFormat vhost_plus_combined

LogFormat "%a %h %>s %B %m %H %T %v %p %t \"%r\"" ip_tracking

LogFormat "%h %l %u %t \"%r\" %>s %B \"%{Referer}i\" \"%{User-agent}i\" %V %a" combined_plus_vhost_ip

# new log format for cluster replaces access_log+traffic_log with an expanded access log:
#
# timestamp node number "combined log" virtual-host canonical-virtual-host IP-address input-bytes output-bytes
LogFormat "%{%Y-%m-%d %H:%M:%S}t %{NODENUMBER}e %h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-agent}i\" %V %v %a  %I %O" extended1


<IfDefine !CLUSTER>
    # nuinfo/chnuinfo
    <IfDefine !TESTSERVER>
        CustomLog /nuinfo/current-logs/httpd/logs/access_log vhost_plus_combined
    </IfDefine>

    <IfDefine TESTSERVER>
        CustomLog /nuinfo/current-logs/httpd/test-logs/access_log vhost_plus_combined
    </IfDefine>

    # end if not cluster
</IfDefine>

# Note: The access log for the cluster is defined below

# optional logging of IP and status, superceeded in the cluster
<IfDefine !CLUSTER>
    <IfDefine TRAFFICLOG>
         <IfModule mod_logio.c>
                # date remote-ip remote-host canonical-virtual-host input-bytes output-bytes status seconds
                LogFormat "%{%Y-%m-%d %H:%M:%S}t %a %h %v %I %O %>s %T" traffic1

            <IfDefine !TESTSERVER>
                CustomLog /nuinfo/current-logs/httpd/logs/traffic_log traffic1
            </IfDefine>

            <IfDefine TESTSERVER>
                CustomLog /nuinfo/current-logs/httpd/test-logs/traffic_log traffic1
            </IfDefine>
        </IfModule>
    </IfDefine>
</IfDefine>

<IfDefine CLUSTER>
    # new log format for cluster replaces access_log+traffic_log with expanded access log

    # This block of directives exists to omit some requests from the main access log
    # Added on 06-24-2011, ptk247, skip entries from the 2020 ridge testing server
    # 2020rdg-hc215-test.northwestern.edu
    SetEnvIf Remote_Addr "129\.105\.215\.211" donotlogthis
    # groundwork.ci.northwestern.edu
    SetEnvIf Remote_Addr "129\.105\.106\.28" donotlogthis
    # Similarly separate the requests for robots.txt and favicon.ico and health-check-test.txt
    SetEnvIf Request_URI "^/robots\.txt$" donotlogthis
    SetEnvIf Request_URI "^/favicon\.ico$" donotlogthis
    # load-balancer health check URL
    SetEnvIf Request_URI "^/health\-check\-test\.txt$" donotlogthis


    <IfDefine !ROTATELOGS>
        # error_log, access_log rotated externally
        <IfDefine !TESTSERVER>
            ErrorLog  /var/log/httpd/error_log

            CustomLog /var/log/httpd/access_log         extended1 env=!donotlogthis
            CustomLog /var/log/httpd/access_log_skipped extended1 env=donotlogthis
        </IfDefine>

        <IfDefine TESTSERVER>
            ErrorLog  /var/log/test-httpd/error_log

            CustomLog /var/log/test-httpd/access_log         extended1 env=!donotlogthis
            CustomLog /var/log/test-httpd/access_log_skipped extended1 env=donotlogthis
        </IfDefine>
    </IfDefine>

    <IfDefine ROTATELOGS>
        # error_log, access_log piped to rotatelogs, with per-host filenames

        # There seems to be no way to substitute something in the filename
        # so we need an IfDefine on the node name symbol (ack!)

        # /usr/local/sbin/rotatelogs was built as a static binary from
        # Apache 2.2.21 sources

        <IfDefine HEVNUINFOW1>
            # server evnuinfow1.it.northwestern.edu

            <IfDefine !TESTSERVER>
                # port 80 production server instance
                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/error_log_evnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_evnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_skipped_evnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 80

            </IfDefine>

            <IfDefine TESTSERVER>
                # port 8002 test server instance

                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/error_log_evnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_evnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_skipped_evnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 8002
            </IfDefine>

            # end if server evnuinfow1
        </IfDefine>

        <IfDefine HEVNUINFOW2>
            # server evnuinfow2.it.northwestern.edu

            <IfDefine !TESTSERVER>
                # port 80 production server instance
                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/error_log_evnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_evnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_skipped_evnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 80

            </IfDefine>

            <IfDefine TESTSERVER>
                # port 8002 test server instance

                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/error_log_evnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_evnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_skipped_evnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 8002
            </IfDefine>

            # end if server evnuinfow2
        </IfDefine>

        <IfDefine HEVNUINFOW3>
            # server evnuinfow3.it.northwestern.edu

            <IfDefine !TESTSERVER>
                # port 80 production server instance
                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/error_log_evnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_evnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_skipped_evnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 80

            </IfDefine>

            <IfDefine TESTSERVER>
                # port 8002 test server instance

                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/error_log_evnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_evnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_skipped_evnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 8002
            </IfDefine>

            # end if server evnuinfow3
        </IfDefine>

        <IfDefine HCHNUINFOW1>
            # server chnuinfow1.it.northwestern.edu

            <IfDefine !TESTSERVER>
                # port 80 production server instance
                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/error_log_chnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_chnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_skipped_chnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 80

            </IfDefine>

            <IfDefine TESTSERVER>
                # port 8002 test server instance

                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/error_log_chnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_chnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_skipped_chnuinfow1.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 8002
            </IfDefine>

            # end if server chnuinfow1
        </IfDefine>

        <IfDefine HCHNUINFOW2>
            # server chnuinfow2.it.northwestern.edu

            <IfDefine !TESTSERVER>
                # port 80 production server instance
                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/error_log_chnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_chnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_skipped_chnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 80

            </IfDefine>

            <IfDefine TESTSERVER>
                # port 8002 test server instance

                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/error_log_chnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_chnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_skipped_chnuinfow2.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 8002
            </IfDefine>

            # end if server chnuinfow2
        </IfDefine>

        <IfDefine HCHNUINFOW3>
            # server chnuinfow3.it.northwestern.edu

            <IfDefine !TESTSERVER>
                # port 80 production server instance
                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/error_log_chnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_chnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/httpd/access_log_skipped_chnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 80

            </IfDefine>

            <IfDefine TESTSERVER>
                # port 8002 test server instance

                # error log
                ErrorLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/error_log_chnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400"

                # primary access log
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_chnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=!donotlogthis

                # log of skipped requests
                CustomLog "|/usr/local/sbin/rotatelogs -f  /var/log/test-httpd/access_log_skipped_chnuinfow3.%Y-%m-%d-%H_%M_%S.txt 86400" extended1 env=donotlogthis

                # end if port 8002
            </IfDefine>

            # end if server chnuinfow3
        </IfDefine>

        # end if rotatelogs
    </IfDefine>

    # end if cluster
</IfDefine>

# PidFile: The file the server should log its pid to
<IfDefine !CLUSTER>

    <IfDefine !TESTSERVER>
    PidFile /nuinfo/current-logs/httpd/logs/httpd.pid
    </IfDefine>

    <IfDefine TESTSERVER>
    PidFile /nuinfo/current-logs/httpd/test-logs/httpd.pid
    </IfDefine>

    # end if not cluster
</IfDefine>

<IfDefine CLUSTER>
    # Most things interact with the /etc/init.d/FOO scripts
    # but some Linux scripts/commands may look for pid files in /var/run
    # so follow that convention
    <IfDefine !TESTSERVER>
        # Red Hat defines a server root of /etc/httpd and
        # makes a symlink /etc/httpd/run -> ../../var/run
        # So the pid file is really /var/run/httpd.pid
        PidFile /var/run/httpd.pid
    </IfDefine>

    <IfDefine TESTSERVER>
        PidFile /var/run/test-httpd.pid
    </IfDefine>

    # end if cluster
</IfDefine>

# extra logging stuff only on port 8002 test server, and not rotated
<IfDefine !CLUSTER>

    <IfDefine TESTSERVER>
        # ScriptLog only for test server
        ScriptLog /nuinfo/current-logs/httpd/test-logs/script_log

        # RewriteLog only for test server
        RewriteLogLevel 5
        RewriteLog /nuinfo/current-logs/httpd/test-logs/rewrite_log

        # tests of custom formats 12-16-05
        #CustomLog /nuinfo/current-logs/httpd/test-logs/test1_log ip_tracking

        #CustomLog /nuinfo/current-logs/httpd/test-logs/test2_log combined_plus_vhost_ip

    </IfDefine>

    # end if not cluster
</IfDefine>

<IfDefine CLUSTER>

    <IfDefine TESTSERVER>
        # Having extra port 8002 logging causes too much traffic
        # on the load-balanced port 8002 in the cluster
        # comment these out 1-14-2012
        # ScriptLog only for port 8002 test server
        # ScriptLog /var/log/test-httpd/script_log

        # RewriteLog only for test server
        # RewriteLogLevel 5
        #RewriteLog /var/log/test-httpd/rewrite_log

    </IfDefine>

    # end if cluster
</IfDefine>

# ScoreBoardFile: File used to store internal server process information
# (This seems not to be needed on HP-UX or Solaris)
<IfDefine !CLUSTER>

#    <IfDefine !APACHE2>
#        # Explictly specifying ScoreBoardFile causes trouble in some Apache 2
#        # per-build shared library loading schemes; Solaris seems OK without it 8-16-06
#        <IfDefine !TESTSERVER>
#            ScoreBoardFile /nuinfo/current-logs/httpd/logs/apache_status
#        </IfDefine>
#
#        <IfDefine TESTSERVER>
#            ScoreBoardFile /nuinfo/current-logs/httpd/test-logs/apache_status
#        </IfDefine>
#    </IfDefine>

    # end not cluster
</IfDefine>

# I don't know if Linux Apache 2.2 needs this, but if so, put it in the log directory

# Red Hat httpd is built with the default ScoreBoardFile
# path "logs/apache_runtime_status" and the default server root "/etc/httpd".
#
# That would give "/etc/httpd/logs/apache_runtime_status".
#
# But I think it makes more sense to put it in our per-node log directories
# "/var/log/httpd" or "/var/log/test-httpd"
<IfDefine CLUSTER>
    # Linux log directories are under /var/log
    <IfDefine !TESTSERVER>
        ScoreBoardFile /var/log/httpd/apache_runtime_status
    </IfDefine>

    <IfDefine TESTSERVER>
        ScoreBoardFile /var/log/test-httpd/apache_runtime_status
    </IfDefine>

    # end cluster
</IfDefine>

# specify full path so we can use version-specific server roots 8-16-06
#
# This accept.lock file needs to be in a local writeable directory, not NFS mounted
# so put it in the primary log directory for this instance
# (No other processes need to find/access it)

<IfDefine !CLUSTER>
    <IfDefine !TESTSERVER>
    LockFile /nuinfo/current-logs/httpd/logs/accept.lock
    </IfDefine>

    <IfDefine TESTSERVER>
    LockFile /nuinfo/current-logs/httpd/test-logs/accept.lock
    </IfDefine>

    # end not cluster
</IfDefine>

<IfDefine CLUSTER>
    # Linux log directories are under /var/log
    <IfDefine !TESTSERVER>
    LockFile /var/log/httpd/accept.lock
    </IfDefine>

    <IfDefine TESTSERVER>
    LockFile /var/log/test-httpd/accept.lock
    </IfDefine>

    # end cluster
</IfDefine>

# ServerName allows you to set a host name which is sent back to clients for
# your server if it's different than the one the program would get (i.e. use
#"www" instead of the host's real name).

ServerName www.northwestern.edu

# to help host name logging 3/8/00
UseCanonicalName off

<IfDefine RANGEFIX>
    # drop Range and Request-Range headers with too many byte ranges
    # to work-around DOS attack CVE-2011-3192
    # http://article.gmane.org/gmane.comp.apache.announce/58
    # http://www.kb.cert.org/vuls/id/405811

    # This doesn't work with Apache 2.0.xx
    #SetEnvIf Range (,.*?){5,} bad-range=1
    #SetEnvIf Request-Range (,.*?){5,} bad-range=1
    #
    #RequestHeader unset Range env=bad-range
    #RequestHeader unset Request-Range env=bad-range

    # second fix from http://www.kb.cert.org/vuls/id/405811
    #----------
    # Reject request when more than 5 ranges in the Range: header.
    #
    RewriteEngine on
    RewriteCond %{HTTP:range} !(bytes=[^,]+(,[^,]+){0,4}$|^$)
    RewriteRule .* - [F]

    # We always drop Request-Range; as this is a legacy
    # dating back to MSIE3 and Netscape 2 and 3.
    RequestHeader unset Request-Range
    #----------

</IfDefine>

#- - - - -
# Browser hacks on keepalive, etc.
# local CGI bug
BrowserMatch "Mozilla/3\.[0-9]+ \(Win" nokeepalive
# recommended by Apache docs
BrowserMatch "Mozilla/2" nokeepalive
BrowserMatch "MSIE 4\.02b;" nokeepalive
BrowserMatch "MSIE 4\.02b;" downgrade-1.0 force-response-1.0
BrowserMatch "Java1\.0" force-response-1.0
BrowserMatch "JDK/1\.0" force-response-1.0
BrowserMatch "RealPlayer 4\.0" force-response-1.0


# KeepAlive: The number of Keep-Alive persistent requests to accept
# per connection. Set to 0 to deactivate Keep-Alive support

KeepAlive on
#- - - - -

# KeepAliveTimeout: Number of seconds to wait for the next request
# decrease to 10 12-9-08

KeepAliveTimeout 10

<IfDefine APACHE22>
    #
    # GracefulShutDownTimeout: Specify a timeout after which
    # a gracefully shutdown server will exit. (new in Apache 2.2)
    #
    # "The GracefulShutdownTimeout specifies how many seconds after
    # receiving a "graceful-stop" signal, a server should continue to run,
    # handling the existing connections."
    #
    # "Setting this value to zero means that the server will wait
    # indefinitely until all remaining requests have been fully served."

    # It appears that setting this too long can interfere with
    # server restarts done using a HUP.
    #
    # This isn't documented, but 60 seconds seems to be too long

    GracefulShutDownTimeout 20

</IfDefine>


# decrease from 10 to 7     9/19/00 because of performance concerns
# increase to 10 on Solaris 7-21-02
# increase to 20 2-2-2011
MinSpareServers 20
# decrease from 20 to 15    9/19/00 because of performance concerns
# increase to 20 on Solaris 7-21-02
# increase to 30 2-2-2011
# increase to 40 2-2-2011
MaxSpareServers 40

# we are using the Prefork model

StartServers 10

# Timeout: The number of seconds before receives and sends time out
Timeout 300

# decrease from 256 to 150 9/19/00 because of performance concerns
# reduce from 150 to 130 9/22/00
# reduce to 80 to reduce use of swap (related to crash 5-30-01)
# reduce to 50 to reduce use of swap 6-8-01
# bump up to 80 6-11-01
# set back to 130 6-11-01
# increase to 200 on Solaris 7-21-02
# increase to 230 12-4-08
# increase MaxClients to 260 12-8-08
# increase MaxClients to 300 12-9-08
# increase MaxClients to 350 12-16-08
# increase MaxClients to 550 1-20-08
# increase MaxClients to 650 2-1-11

# Set ServerLimit and MaxClients to the same value since we do a
# full restart, not a HUP on most configuration changes
# Explicitly setting ServerLimit lets us increase MaxClients over 256 (12-8-08)
<IfDefine !CLUSTER>
ServerLimit 650
MaxClients 650
</IfDefine>
<IfDefine CLUSTER>
ServerLimit 2600
MaxClients 2600
</IfDefine>

MaxRequestsPerChild 600
#

# specify full path so we can use version-specific server roots 8-16-06
<IfDefine !CLUSTER>
    # nuinfo/chnuinfo
    <IfDefine !TESTSERVER>
        TypesConfig /nuinfo/httpd/conf/mime.types
    </IfDefine>
    <IfDefine TESTSERVER>
        TypesConfig /nuinfo/httpd/test-conf/mime.types
    </IfDefine>

    # end if not cluster
</IfDefine>

<IfDefine CLUSTER>
    <IfDefine !TESTSERVER>
        TypesConfig /etc/httpd/conf/mime.types
    </IfDefine>
    <IfDefine TESTSERVER>
        TypesConfig /etc/httpd/test-conf/mime.types
    </IfDefine>

    # end not cluster
</IfDefine>

# server-wide environment variable for NU domain test
# this will have a value of "1" or be unset, it's not a zero/one variable
#
# To test in SSIs use: <!--#if expr="$FROM_NU_DOMAIN = '1'" -->
#
SetEnvIfNoCase Remote_Host "nwu\.edu$" FROM_NU_DOMAIN 1
SetEnvIfNoCase Remote_Host "northwestern\.edu$" FROM_NU_DOMAIN 1

# server-wide environment variable to help us special-case the prototype host 1-2-02
SetEnv  PRODUCTION_SERVER   "1"

# environment variable for Sun web SSO agent 8-17-06
# may or may not be needed in subprocess environment
#PassEnv JAVA_HOME

#---------------------------------------
# memory cache experiments 1-20-09
<IfDefine MCACHE>
    <IfModule mod_cache.c>
    <IfModule mod_mem_cache.c>

        # 30 min max expire
        CacheMaxExpire 1800

        # 256 Mbyte cache
        MCacheSize 262144

        MCacheMaxObjectCount 500

        MCacheMinObjectSize 10

        # 2 Mbyte Max object size
        MCacheMaxObjectSize 2097152

        MCacheRemovalAlgorithm GDSF


    </IfModule>
    </IfModule>
</IfDefine>

# mod_deflate experiments 5-13-09
<IfDefine DEFLATE>
    <IfModule mod_deflate.c>

        # the size in bytes of the fragments that zlib should compress at one time.
        DeflateBufferSize 8096

        # What level of compression should be used
        # The higher the value, the better the compression
        # The value must between 1 (less compression) and 9 (more compression).
        DeflateCompressionLevel 6

        # How much memory should be used by zlib for compression
        # (a value between 1 and 9).
        DeflateMemLevel 8

        # The zlib compression window size (a value between 1 and 15)
        # Generally, the higher the window size, the higher can
        # the compression ratio be expected.
        DeflateWindowSize 15

        # Netscape 4.x has some problems...
        BrowserMatch ^Mozilla/4 gzip-only-text/html

        # Netscape 4.06-4.08 have some more problems
        BrowserMatch ^Mozilla/4\.0[678] no-gzip

        # MSIE masquerades as Netscape, but it is fine
        # BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

        # Use AddOutputFilterByType to turn on selectively in containers, like:
        # "AddOutputFilterByType INCLUDES;DEFLATE text/html"

        # Append Vary: header where we actually turn on the filter, using:
        # "Header append Vary User-Agent"

       SetOutputFilter DEFLATE
       AddOutputFilterByType DEFLATE text/html

    </IfModule>
</IfDefine>

#---------------------------------------


# This one DENYFORTEST block has no corresponding "allow"
# It is an extra restriction to try to prevent leakage during testing
<IfDefine DENYFORTEST>
    <Location / >
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </Location>

    # end DENYFORTEST
</IfDefine>

<VirtualHost _default_>
    #<<<<cluster we might need to change this

    # New fallback host for all otherwise unspecified requests, added 10-25-05,
    # introduced to disambiguate no-IP configurations

    # We use a _different_ server name than the main host
    # to keep it from stealing requests from the main host despite being the
    # first explicit VirtualHost

    # NOTE: REMOVING THIS ServerName DIRECTIVE WILL BREAK www.northwestern.edu

    ServerName fallback.northwestern.edu

    DocumentRoot /nuinfo/httpd/more-docs/name-virtual-host-doc-root

    #RewriteEngine on
    #RewriteOptions inherit

    # disable the normal CGI directory on this error site
    ScriptAlias /cgi-bin/   /nuinfo/httpd/more-docs/empty-placeholder/

    # nearly all requests get the same message
    ErrorDocument 404 /index.html

</VirtualHost>


# ###########################################################
# aliases and redirects that we don't want inherited by other virtual hosts
# except hosts set up specifically to imitate the main host
# ###########################################################

# main host VirtualHost

# AUTOMATIC CHANGE FOR IP ADDRESS REMOVAL
# WAS: <VirtualHost 129.105.212.72>
<VirtualHost *>
    ServerName www.northwestern.edu
    #ServerAlias www.nwu.edu
    #ServerAlias www.acns.nwu.edu
    # NOT www.it.northwestern.edu, that's a virtual host
    #ServerAlias nuinfo.nwu.edu
    ServerAlias nuinfo.northwestern.edu
    #ServerAlias nuinfo.acns.nwu.edu
    #ServerAlias nuinfo.it.northwestern.edu
    # add newmoon for testing Solaris 7-1-02
    #ServerAlias newmoon.nwu.edu
    #ServerAlias newmoon.northwestern.edu

    # Add "northwestern.edu" for future move of the A record
    # This will redirect to www.northwestern.edu, it's
    # not a special case like chnuinfo that does not redirect
    ServerAlias northwestern.edu

    # alias for chicago mirror host, treat like main host 12-12-07
    ServerAlias chnuinfo.northwestern.edu

    <IfDefine USEEVNUINFOPROTO2>
    ServerAlias evnuinfo-proto2.northwestern.edu
    ServerAlias chnuinfo-proto2.northwestern.edu
    </IfDefine>

    <IfDefine EXPOSENODES>
        # expose the cluster nodes as names for the main host and do not redirect
        # We DO NOT want to do this in production
        # Access manager rules were not designed with this in mind
        ServerAlias evnuinfow1.it.northwestern.edu
        ServerAlias evnuinfow2.it.northwestern.edu
        ServerAlias evnuinfow3.it.northwestern.edu
        ServerAlias chnuinfow1.it.northwestern.edu
        ServerAlias chnuinfow2.it.northwestern.edu
        ServerAlias chnuinfow3.it.northwestern.edu
        # add load-balanced VIP addresses to this list 11-11-2011
        ServerAlias nuinfo-vip.it.northwestern.edu
        ServerAlias chnuinfo-vip.it.northwestern.edu
        # add cross-campus VIP 12-2-11
        ServerAlias nuinfo.wideip.northwestern.edu
    </IfDefine>

    # Otherwise the node names are attached to the nuinfotest.it.northwestern.edu
    # virtual host which has safer dummy content

    # gopher.northwestern.edu is a just placeholder for a dead service
    # But we configure it explictly here, to make it do what we want in a no-IP configuration 10-25-05
    # (The prefered-host-name redirect sends this to www.northwestern.edu)
    ServerAlias gopher.northwestern.edu

    # nuinfoev.northwestern.edu is an alias that just applies
    # to the Evanston server (or servers in the future) for testing
    #
    # *DON'T* bypass the redirect of secondary web server names for it
    # so that we don't need to put this in every websso rule like
    # we do for chnuinfo
    #
    # This is listed here partly to get it in the DNS names report.
    # It is NOT expected to act like the main host.
    <IfDefine !CLUSTER>
        <IfDefine !MIRROR>
        ServerAlias nuinfoev.northwestern.edu
        </IfDefine>
    </IfDefine>

    # to bypass rewriting in the SNAP netid proxy CGI 10-17-03
    ServerAlias nuinfo-noproxy.northwestern.edu

    # 11-2-01
    # main-head.conf is stuff that only applies to the main host,
    # and _not_ virtual hosts that clone it
    # (it used to me at the start of main-only.conf)

    <IfDefine !CLUSTER>
        <IfDefine !TESTSERVER>
            include /nuinfo/httpd/conf/main-head.conf
        </IfDefine>

        <IfDefine TESTSERVER>
            include /nuinfo/httpd/test-conf/main-head.conf
        </IfDefine>

        # end if not cluster
    </IfDefine>

    <IfDefine CLUSTER>
        <IfDefine !TESTSERVER>
            include /etc/httpd/conf/main-head.conf
        </IfDefine>

        <IfDefine TESTSERVER>
            include /etc/httpd/test-conf/main-head.conf
        </IfDefine>

        # end if cluster
    </IfDefine>

    # 11-2-01
    # main-only.conf is directives that can be shared
    # by virtual host clones of the main host

    <IfDefine !CLUSTER>
        <IfDefine !TESTSERVER>
            include /nuinfo/httpd/conf/main-only.conf
        </IfDefine>

        <IfDefine TESTSERVER>
            include /nuinfo/httpd/test-conf/main-only.conf
        </IfDefine>

        # end if not cluster
    </IfDefine>

    <IfDefine CLUSTER>
        <IfDefine !TESTSERVER>
            include /etc/httpd/conf/main-only.conf
        </IfDefine>

        <IfDefine TESTSERVER>
            include /etc/httpd/test-conf/main-only.conf
        </IfDefine>

        # end if cluster
    </IfDefine>

</VirtualHost>


# ###########################################################
# virtual hosts config includes

<IfDefine !CLUSTER>
    <IfDefine !TESTSERVER>
        include /nuinfo/httpd/conf/virtual.conf
    </IfDefine>

    <IfDefine TESTSERVER>
        include /nuinfo/httpd/test-conf/virtual.conf
    </IfDefine>
</IfDefine>

<IfDefine CLUSTER>
    <IfDefine !TESTSERVER>
        include /etc/httpd/conf/virtual.conf
    </IfDefine>

    <IfDefine TESTSERVER>
        include /etc/httpd/test-conf/virtual.conf
    </IfDefine>
</IfDefine>


# end virtual hosts config
#

# ###########################################################
# start of former srm.conf
# ###########################################################

# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.

DocumentRoot /nuinfo/httpd/htdocs

# UserDir: The name of the directory which is appended onto a user's home
# directory if a ~user request is recieved.

# UserDir public_html
# NUInfo/www.northwestern.edu doesn't support personal web pages.
UserDir disabled

# recommended in 1.2.0 to fix problems with keepalive and Netscape 2.x
# Added 7/2/97
BrowserMatch Mozilla/2 nokeepalive

# DirectoryIndex: Name of the file to use as a pre-written HTML
# directory index

# index.html then index.htm added 4/17/96
# Default.html welcome.html added 7/1/97
# index.ssi index.shtml index.asp added 5/17/99
# index.xml added 11-17-06
#
DirectoryIndex index.html index.htm Default.html welcome.html index.ssi index.shtml index.asp index.xml

# fancy indexing minus ignore/readme features added 7/1/97

IndexOptions FancyIndexing IconsAreLinks

# Default Expiration Times - added 11/26/97 because of interaction
# with SSI last mod times
# This will allow some caching of SSI pages

ExpiresActive On
# 24 hours after access time for unknown types
ExpiresDefault A86400

# Images expire in a week
ExpiresByType image/gif A604800
ExpiresByType image/jpeg A604800
ExpiresByType image/png A604800

<IfDefine !EXPOSENODES>
    # Expire text in 6 hours
    ExpiresByType text/html A21600
</IfDefine>
<IfDefine EXPOSENODES>
    # testing only, the EXPOSENODES option should not be used in production
    # Expire text in 5 minutes
    ExpiresByType text/html A300
</IfDefine>

<Directory /nuinfo/httpd/htdocs/virtualstore/ >
# special case for /virtualstore/ added 7/17/98

# Expire text in 2 hours
ExpiresByType text/html A7200

</Directory>


<Directory /nuinfo/httpd/htdocs/top-menu/ >
# special case for older top menu directory 8-3-06

# Expire text in 1 hour
ExpiresByType text/html A3600

</Directory>
<Directory /nuinfo/httpd/htdocs/www-v5/ >
# special case for newer top menu directory 8-3-06

# Expire text in 1 hour
ExpiresByType text/html A3600

</Directory>

# <Location> blocks for main host moved to main-only.conf 3-27-07
# to avoid side effects on virtual hosts

# note: Hereandnow has a server-wide expire time setting

# AddIcon tells the server which icon to show for different files or filename
# extensions

AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip

AddIconByType (TXT,/icons/text.gif) text/*
AddIconByType (IMG,/icons/image2.gif) image/*
AddIconByType (SND,/icons/sound2.gif) audio/*
AddIconByType (VID,/icons/movie.gif) video/*

AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
# AddIcon /icons/layout.gif .html .shtml .htm .pdf
# add new server-side include types 10-16-97
AddIcon /icons/layout.gif .html .shtml .htm .pdf .ssi .asp
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif core

AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^

# DefaultIcon is which icon to show for files which do not have an icon
# explicitly set.

DefaultIcon /icons/unknown.gif

# end of fancy indexing

# AccessFileName: The name of the file to look for in each directory
# for access control information.

AccessFileName .htaccess

# DefaultType is the default MIME type for documents which the server
# cannot find the type of from filename extensions.

DefaultType text/plain

# AddType allows you to tweak mime.types without actually editing it, or to
# make certain files to be certain types.
# Format: AddType type/subtype ext1

AddType text/html crd
#
# We _don't_ want this:
#AddType application/x-httpd-cgi cgi

# Stuff for viewing tidle files 10/7/97
AddType text/html html~
AddType text/html htm~
AddType text/html HTML~
AddType text/html HTM~

# explict extensions for server-side includes 10/16/97
AddType text/html .shtml
AddHandler server-parsed .shtml

# Added for cross-platform compatiblity with Webstar
AddType text/html .ssi
AddHandler server-parsed .ssi

# Added for cross-platform compatiblity with MS IIS
AddType text/html .asp
AddHandler server-parsed .asp

# SSIs everywhere - test 7/14/00 (not put in production) - retest 7/25/00
AddType text/html .html
AddHandler server-parsed .html
#
AddType text/html .htm
AddHandler server-parsed .htm

# Requested by Adam Skrzypulec on 10/11/13
AddType image/svg+xml svg

# 10/29/98 special exception for www.univsvcs.northwestern.edu and www.gensvcs.northwestern.edu
# change the default mime type for /university-services/ stuff moved from
# mac that does not end in .html
<Directory /nuinfo/httpd/htdocs/university-services >
    DefaultType text/html
</Directory>

# the Imagemap module is required for Apache 2.2.x
# "New" ImageMap support
AddHandler imap-file map

# Treatment of bogus coodinates
ImapMenu semiformatted

# new Apache 1.1.1 additions for content negotiation
# AddLanguage allows you to specify the language of a document. You can
# then use content negotiation to give a browser a file in a language
# it can understand.  Note that the suffix does not have to be the same
# as the language keyword --- those with documents in Polish (whose
# net-standard language code is pl) may wish to use "AddLanguage pl .po"
# to avoid the ambiguity with the common suffix for perl scripts.

AddLanguage en .en
AddLanguage fr .fr
AddLanguage de .de
AddLanguage da .da
AddLanguage el .el
AddLanguage it .it

# LanguagePriority allows you to give precedence to some languages
# in case of a tie during content negotiation.
# Just list the languages in decreasing order of preference.

LanguagePriority en fr de

# Redirect allows you to tell clients about documents which used to exist in
# your server's namespace, but do not anymore. This allows you to tell the
# clients where to look for the relocated document.
# Format: Redirect fakename url

# Order is significant for Redirect and Alias
# Group by the top level directory affected, usually put longest first

# most general or it redirects moved to main-only.conf 6-15-00

# many aliases moved to main-only.conf 6-15-00

# ------------------------------------------
# Aliases added for virtual hosts to inherit: do not remove
# Albert Lunde 7/1/97
Alias /icons/ /nuinfo/httpd/icons/
Alias /image/ /nuinfo/httpd/htdocs/image/

# global prefix /shared/ for UR to use in templates, etc. 1-10-02
Alias /shared/ /nuinfo/httpd/more-docs/shared/

# image directories for specific CGIs - Albert Lunde 11-12-01

# This was made visible on all virtual hosts
# because /cgi-bin/ is visible on all virtual hosts

Alias /cgi-script-images/ /nuinfo/httpd/more-docs/cgi-script-images/

# ------------------------------------------

# Special alias to reference some IT server side includes
# outside the IT virtual host, for things like /resnet/ 8-9-01
Alias /ssi/it/menu-ssi/     /nuinfo/httpd/htdocs/it-menu/menu-ssi/

# Note here: ORDER OF ALIASES IS SIGNIFICANT: THE MOST SPECIFIC MUST GO FIRST

# temporary override 12-3-01
#Alias /ssi/top/ /nuinfo/httpd/more-docs/ssi/top.temp/

# Alias for server-side includes 9/30/97
Alias /ssi/ /nuinfo/httpd/more-docs/ssi/


# alias for testing ssi conversion 10-7-97
# turn off 4-4-00
# Alias /ssi-convert-logs/ /nuinfo/httpd/test-ssi/ssi-convert-logs/
# ------------------------------------------

# ------------------------------------------
# Health check html SSI and text file for the load-balancer 9-30-2011
# Aliased into all virtual hosts
Alias /health-check-test.html /nuinfo/httpd/more-docs/health-check-document/health-check-test.html
Alias /health-check-test.txt /nuinfo/httpd/more-docs/health-check-document/health-check-test.txt
# add directory of generated HTML files 11-2-2011
Alias /health-check-test-files/ /nuinfo/httpd/more-docs/health-check-document/test-files/
<Directory /nuinfo/httpd/more-docs/health-check-document>
    # Expire in 15 seconds
    ExpiresByType text/html A15
    ExpiresByType text/plain A15

    order allow,deny
    allow from all

</Directory>
# ------------------------------------------

# ------------------------------------------
# Alias for "private" directories

# TSS Consulting services, for Lynne 8-24-03
# in case we need access direct to proxy
Alias /it-tss-cs-private/ /nuinfo/httpd/more-docs/csstaff-private/private/

# for access via itstaff's proxy, below
Alias /it-staff-private/TSS/cs/ /nuinfo/httpd/more-docs/csstaff-private/private/
# itstaff proxy access 2-18-99
Alias /it-staff-private/ /nuinfo/httpd/more-docs/itstaff-private/private/

<Location /it-staff-private/TSS/tandw >
    # prepare for move of IT and TSS Intanet sites 2-2-07
    # deny access to URL corresponding to old directors-only site in proxy CGI
    order deny,allow
    deny from all
</Location>

# form for it consulting services and facilities management 7-17-01
Alias /it-cs-private/ /nuinfo/httpd/htdocs/it/cs/private/

# new directory for possible cms-managed "private" files 8-12-04
Alias /it-cms-private/ /nuinfo/httpd/more-docs/it-cms-private/private/

<Directory /nuinfo/httpd/more-docs/it-cms-private/private>
    # access restrictions here rather than in .htaccess

    # force this directory to go through the SNAP netid proxy
    # https://snap.it.northwestern.edu/p/p.cgi/somealias/something.html
    #
    order deny,allow
    deny from all
    #
    # allow from snap.it.northwestern.edu (proxy cgi)
    # list all IP addresses
    allow from 129.105.16.59
    allow from 129.105.16.159
    allow from 129.105.16.169

</Directory>

# ------------------------------------------


# General aliases here:
# replace with Redirect of www.northwestern.edu/jazz to www.wnur.org/jazz 8-16-04
#Alias /jazz /nuinfo/httpd/htdocs/WNUR/jazz
#Redirect the corresponding search CGI on all hosts, too 8-16-04
Redirect /cgi-bin/jazz-search.pl    http://www.wnur.org/cgi-bin/jazz-search.pl

#Alias /waits /nuinfo/httpd/htdocs/music/waits
#Alias /eno-l /nuinfo/httpd/htdocs/music/eno
#Alias /gabriel /nuinfo/httpd/htdocs/music/gabriel
#Alias /blink  /nuinfo/httpd/htdocs/ezines/blink
#Alias /guitar /nuinfo/httpd/htdocs/music/guitar
#Alias /astro /usrlocal/etc/httpd/htdocs/demos/astro


# ScriptAlias: This controls which directories contain server scripts.
# Format: ScriptAlias fakename realname


# main CGI directory
ScriptAlias /cgi-bin/ /nuinfo/httpd/cgi-bin/

# 1-29-98 - turn off Expires on CGIs to reduce bogus
# caching of cgi results

<Location /cgi-bin/ >
ExpiresActive Off
</Location>

<Directory /nuinfo/httpd/cgi-bin/ >
ExpiresActive Off
</Directory>

# special error document for /cgi-bin/ on mirror host
<IfDefine MIRROR>

    Alias /mirror-only-cgi-error/ /nuinfo/httpd/more-docs/mirror-only/cgi-not-available/

    <Location /cgi-bin/ >
    ErrorDocument 404 /mirror-only-cgi-error/
    </Location>

</IfDefine>

# special error documents for /cgi-bin/ on cluster host
# nuinfo accounting go away message

# make the alias on all hosts for testing
Alias /nuinfo-acc-not-available-error/ /nuinfo/httpd/more-docs/cluster-only/nuinfo-acc-not-available/
Alias /cluster-only-cgi-error/ /nuinfo/httpd/more-docs/cluster-only/cgi-not-available/

<IfDefine CLUSTER>

    <Location /cgi-bin/ >
    ErrorDocument 404 /cluster-only-cgi-error/
    </Location>

    RedirectMatch permanent ^/department-accounting/    http://www.northwestern.edu/nuinfo-acc-not-available-error/
    RedirectMatch permanent ^/department-accounting$    http://www.northwestern.edu/nuinfo-acc-not-available-error/

    RedirectMatch permanent ^/passport-auth/cgi/dept-database/  http://www.northwestern.edu/nuinfo-acc-not-available-error/
    RedirectMatch permanent ^/passport-auth/cgi/dept-database$  http://www.northwestern.edu/nuinfo-acc-not-available-error/

    <Location /passport-auth/cgi/dept-database/ >
        ErrorDocument 404 /nuinfo-acc-not-available-error/
    </Location>

</IfDefine>

# redirect dashboard CGI toa URL on www.it.northwestern.edu
# so that URL will control access to it
RedirectMatch ^/cgi-bin/dashboard.pl    http://www.it.northwestern.edu/dashboard/dashboard.pl

# searchable CGI directory for webindex a.k.a. Site Index 5-24-00
# like: http://www.northwestern.edu/cgi-bin/webindex-styled/all/A

# redirect /webindex*    to http://offices.northwestern.edu/ 7-23-09
# in main-head.conf
#ScriptAlias /webindex-pages/ /nuinfo/httpd/cgi-bin/webindex-styled/
#<Location /webindex-pages/ >
#ExpiresActive Off
#</Location>


# set up proxy authenticated CGI and HTML directories

ScriptAlias /proxy-cgi/cgi/ /nuinfo/httpd/proxy-cgi/cgi/
Alias /proxy-cgi/html/ /nuinfo/httpd/proxy-cgi/html/

<Location /proxy-cgi/cgi/ >
    # try to prevent HTTP/1.1 chunking
    SetEnv downgrade-1.0 1

    ExpiresActive Off
</Location>

<Directory /nuinfo/httpd/proxy-cgi/cgi/ >
ExpiresActive Off
</Directory>

# environment variable for special cgi
SetEnvIf Request_URI "^/proxy-cgi/cgi/account/" CGICOOKIE=74570a054ca403441cc077e73d33b716



# new directories added for excite 2/21/96
# search-cgi turned off 1/15/97 because of security alert, and because
# excite no longer in production
#ScriptAlias /search-cgi/ /nuinfo/httpd/search-cgi/
#ScriptAlias /excite-admin-cgi/ /nuinfo/httpd/excite-admin-cgi/

# restricted directory for staff testing 2/28/96
ScriptAlias /staff-test-cgi/ /nuinfo/httpd/staff-test-cgi/

<Location /staff-test-cgi/ >
ExpiresActive Off
</Location>

# restricted directory for staff testing of documents 10/15/98
Alias /staff-test-html/ /nuinfo/httpd/staff-test-html/

# turn off virtual home pages feature 1-26-05, replace with redirects
# virtual home pages (added 1/17/95 by Albert Lunde)
#ScriptAlias /people/ /nuinfo/httpd/cgi-bin/ph-html/
#

# disable direct access through cgi-bin too
Redirect /cgi-bin/ph-html/  http://www.northwestern.edu/people/
Redirect /cgi-bin/ph-html   http://www.northwestern.edu/people/


# manual redirects for people with traffic in the last year and valid alias/web page in ldap 2-16-05
# REMOVE ca April 15,2005 except for 7 grandfathered redirects authorized by TSS
# - - - - -

# Redirect for Craig R Bina crb177 craig@earth.northwestern.edu
Redirect /people/craig/     http://www.earth.northwestern.edu/~craig/
Redirect /people/craig      http://www.earth.northwestern.edu/~craig/


# Redirect for Jerry Goldman    jgoldman j-goldman@northwestern.edu
Redirect /people/j-goldman/     http://oyez.at.northwestern.edu/goldman/
Redirect /people/j-goldman      http://oyez.at.northwestern.edu/goldman/


# Redirect for Janine W Spencer jspencer j-spencer@northwestern.edu
Redirect /people/j-spencer/     http://www.mmlc.northwestern.edu/
Redirect /people/j-spencer      http://www.mmlc.northwestern.edu/


# Redirect for Kenneth Alan Paller  paller kap@northwestern.edu
Redirect /people/kap/       http://www.psych.northwestern.edu/psych/people/faculty/paller/
Redirect /people/kap        http://www.psych.northwestern.edu/psych/people/faculty/paller/


# Redirect for Mark Elliot Jung Beeman  mjb630 mjungbee@northwestern.edu
Redirect /people/mjungbee/      http://www.psych.northwestern.edu/~mjungbee/
Redirect /people/mjungbee       http://www.psych.northwestern.edu/~mjungbee/


# Redirect for Matthew W Taylor mwt876 mtaylor@northwestern.edu
Redirect /people/mtaylor/       http://www.mmlc.northwestern.edu/~matt/
Redirect /people/mtaylor        http://www.mmlc.northwestern.edu/~matt/


# Redirect for Thomas E Whalen  tew267  ew@northwestern.edu
Redirect /people/tew/       http://www.enac.northwestern.edu/~tew/
Redirect /people/tew        http://www.enac.northwestern.edu/~tew/

# - - - - -

<Location /people/ >
    # turn off virtual home pages feature
    # turn off follow-up tricks April 15,2005
    # redirect to explanation page
    RewriteEngine on
    RewriteOptions inherit

    ExpiresActive Off

    RewriteRule ^(.*)   http://www.it.northwestern.edu/error-people-redirect-discontinued/  [R,L]
</Location>


#directory mappings for opentext 6/18/96
# fix /otdoc/ 1-24-97
# update for livelink 7.2 8/26/97
#
#Alias /ot/ /nuinfo/opentext/livelink/httpd/html/
#Alias /otadmin/ /nuinfo/opentext/livelink/httpd/otadmin/html/
#Alias /otdoc/ /nuinfo/opentext/livelink/doc/html/
#ScriptAlias /otadmcgi/ /nuinfo/opentext/livelink/httpd/otadmin/cgi/
#ScriptAlias /otcgi/ /nuinfo/opentext/livelink/httpd/cgi/

# removed entirely 12-7-07
#Alias /otadmin/ /nuinfo/opentext/livelink72/lls/admin/html/
#Alias /ot/ /nuinfo/opentext/livelink72/lls/public/html/
#Alias /otdoc/ /nuinfo/opentext/livelink72/lls/doc/html/
#Alias /lladmin/ /nuinfo/opentext/livelink72/lladmin/
#ScriptAlias /otadmcgi/ /nuinfo/opentext/livelink72/lls/admin/cgi/
#ScriptAlias /otcgi/ /nuinfo/opentext/livelink72/lls/public/cgi/

<Location /otadmcgi/ >
ExpiresActive Off
</Location>

<Location /otcgi/ >
ExpiresActive Off
</Location>

# location to access legacy opentext search 8-22-01
# turn off 10-20-01
#Alias /opentext-search/    /nuinfo/httpd/more-docs/opentext-search/
#Alias /opentext-search /nuinfo/httpd/more-docs/opentext-search/

# turn off feedback cgi 7/21/00
# production: alias /feedback/ directory to feedback cgi 5/11/98
#ScriptAlias /feedback/index.html /nuinfo/httpd/cgi-bin/feedback.cgi

#<Location /feedback/index.html >
#ExpiresActive Off
#</Location>

# test no Expires on a websso directory 11-19-08
<Location /test-websso-auth-dir  >
#ExpiresActive Off
ExpiresDefault now
ExpiresByType text/html now
</Location>

#
# message for /ev-chi/ redirection
Alias /discontinued-ev-chi/ /nuinfo/httpd/more-docs/discontinued-ev-chi/

# special redirects for search-mirror trick
<Directory /nuinfo/httpd/htdocs/search-mirrors >
   RewriteEngine on
   RewriteRule "^([^/]+)/index.html$" "$1/"
   RewriteRule "^([^/]+)/([^/]+)/index.html$" "$1/$2/"
   RewriteRule "^([^/]+)/([^/]+)/([^/]+)/index.html$" "$1/$2/$3/"
   RewriteRule "^([^/]+)/([^/]+)/([^/]+)/([^/]+)/index.html$" "$1/$2/$3/$4/"
   RewriteRule "^([^/]+)/(.*)$" "http://$1/$2" [R]
</Directory>

# rewrite home page of /image/ directory to http://www.northwestern.edu/logo/
# across all virtual hosts
RewriteEngine on
RewriteRule ^/image/$               http://www.northwestern.edu/logo/   [R,L]
RewriteRule ^/image/index.html$ http://www.northwestern.edu/logo/   [R,L]

# RewriteMap to map URLs to lowercase
RewriteMap tolower  int:tolower

# ###########################################################
# start of former access.conf
# ###########################################################

#
# added 6/3/98 explict allow/deny for all directories
# Note that <Directory> sections are applied shortest match first

# everywhere not specified
Options None

# deny everything by default
<Directory / >
    AllowOverride None
    Options None
    order deny,allow
    deny from all
</Directory>

# hide .htaccess files
<Files ~ "\.htaccess*" >
    order allow,deny
    deny from all
</Files>

# hide Mac .DS_Store files accidentally uploaded
<Files ~ "\.DS_Store" >
    order allow,deny
    deny from all
</Files>

# access via the the main document root
<Directory /nuinfo/httpd/htdocs >

    # This may also be "None", or any combination of "Indexes",
    # "Includes", or "FollowSymLinks"

    # Options All
    # changed 6/24/96 to be more paranoid
    Options Indexes IncludesNOEXEC FollowSymLinks

    # allow XBitHack to turn on server side includes
    # Commented out for cluster config 10-3-2011
    # XBitHack is now moot because we have .ssi on for all HTML file types
    # XBitHack full

    # This controls which options the .htaccess files in directories can
    # override. Can also be "None", or any combination of "Options", "FileInfo",
    # "AuthConfig", and "Limit"

    AllowOverride AuthConfig Limit

    # Controls who can get stuff from this server.

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end /nuinfo/httpd/htdocs
</Directory>

# explicitly grant access for Alias, ScriptAlias and virtual hosts outside /nuinfo/httpd/htdocs here:

#----------------------------------
# /proxy-cgi/
<Directory /nuinfo/httpd/proxy-cgi >

    # restrict access by directory for SNAP proxy
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride AuthConfig Limit
    #AllowOverride All

    IndexOptions FancyIndexing IconsAreLinks

    #
    # move access rules to Location block

</Directory>

<Directory /nuinfo/httpd/proxy-cgi/cgi >

    # only allow AllowOverride All on CGI subtree, owned by root, not on shared html
    AllowOverride All

</Directory>

# /proxy-cgi/ - stuff specific to proxy CGI access
<Location /proxy-cgi >
    order deny,allow
    deny from all
    #
    # allow from snap.it.northwestern.edu (proxy cgi)
    allow from 129.105.16.59
    # added second IP 12-17-01
    allow from 129.105.16.159
    # adjust IP list 4-18-03
    allow from 129.105.16.169

    # allow from socrates
    #allow from socrates.tss.nwu.edu
    #allow from socrates.tss.northwestern.edu

    # test proxy from socrates
#   SetEnvIf Remote_Addr "129\.105\.233\.63"    HTTP_REMOTEADDR=129.105.233.63
#   SetEnvIf Remote_Addr "129\.105\.233\.63"    HTTP_REMOTEUSER=lunde

</Location>
#----------------------------------

# /cgi-bin/
<Directory /nuinfo/httpd/cgi-bin/ >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride All

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # Put in Deny directives to block spammers here
    # Use CIDR block syntax
    # Spam from 91.214.45.46 on 2-11-2010
    deny from 91.214.44.0/24
    # Spam from 202.73.13.122 on 2-21-2010
    deny from 202.73.13.0/24
    # spam from 89.97.5.189 on 2-21-2010
    deny from 89.97.5.0/24

    # end /nuinfo/httpd/cgi-bin/
</Directory>

# /cgi-bin/dining-services-menu/
<Directory /nuinfo/httpd/cgi-bin/dining-services-menu >
    AuthType Basic
    AuthUserFile /nuinfo/httpd/cgi-data/dining-services-menu/webconf/menu-passwd
    AuthName "Dining Services Menus"
    require valid-user
</Directory>

# directory with IP restriction for breaking news helper touch-home-two
# 9-6-05
<Directory /nuinfo/httpd/cgi-bin/touch-home-two >
    AllowOverride None
    #
    order deny,allow
    deny from all
    #
    # socrates (Albert Lunde Desktop)
    allow from socrates.tss.northwestern.edu
    # UR/IT WCMS server
    allow from rhodes.it.northwestern.edu
    # random UR desktops, for testing
    allow from ur.northwestern.edu
</Directory>

# /staff-test-cgi/ directories treated below

# /staff-test-html/ directories treated below

# /icons/ alias
<Directory /nuinfo/httpd/icons >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride AuthConfig Limit

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end /nuinfo/httpd/icons
</Directory>

# momspider results alias
# moved off logs 9/23/99
# obsolete, comment out 10-3-11
#<Directory /nuinfo/httpd/more-docs/results >
#    Options Indexes IncludesNOEXEC FollowSymLinks
#    # XBitHack full
#    AllowOverride AuthConfig Limit
#    order allow,deny
#    allow from all
#</Directory>

# more-docs: ssi and other stuff
<Directory /nuinfo/httpd/more-docs >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride All
    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end /nuinfo/httpd/more-docs
</Directory>

# placeholder to Alias in place of redirect directories
# to generate hard errors
<Directory /nuinfo/httpd/more-docs/empty-error-placeholder >
    Options None

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end /nuinfo/httpd/more-docs/empty-error-placeholder
</Directory>


# removed entirely 12-7-07
# Opentext and friends
#<Directory /nuinfo/opentext >
#    Options Indexes IncludesNOEXEC FollowSymLinks
#    # XBitHack full
#    AllowOverride AuthConfig Limit
#    order allow,deny
#    allow from all
#</Directory>

# virtual postcards card data and preview directories
# these are web directories but not trusted a lot
# indexes are disabled to give postcard users more privacy
<Directory /nuinfo/httpd/cgi-data/virtual-postcard/cards >
    Options IncludesNOEXEC
    # XBitHack full
    AllowOverride None

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end nuinfo/httpd/cgi-data/virtual-postcard/cards
</Directory>


# perl5 html docs
<Directory /opt/local/lib/perl5/html >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride None

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end nuinfo/httpd/cgi-data/virtual-postcard/cards
</Directory>

# perl5.6.1 html docs
<Directory /nuinfo/local/perl56/html >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride None

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end nuinfo/httpd/cgi-data/virtual-postcard/cards
</Directory>

# IT test virtual hosts
<Directory /nuinfo/httpd/new-look >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride AuthConfig Limit

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end nuinfo/httpd/cgi-data/virtual-postcard/cards
</Directory>

# UR menus virtual host
<Directory /nuinfo/httpd/new-top >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride AuthConfig Limit

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end /nuinfo/httpd/new-top
</Directory>

# lunde demo virtual host
<Directory /nuinfo/httpd/new-demo2 >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride AuthConfig Limit

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end /nuinfo/httpd/new-demo2
</Directory>

# lunde test-ssi virtual host
<Directory /nuinfo/httpd/test-ssi >
    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride AuthConfig Limit

    <IfDefine !DENYFORTEST>
        # normal "allow from everywhere"
        order allow,deny
        allow from all
    </IfDefine>
    <IfDefine DENYFORTEST>
        # restricted access for preproduction testing
        order deny,allow
        deny from all
        # TSS staff desktops
        allow from 129.105.188.0/24
        # ITMS/Identity Services
        allow from 129.105.233.0/24
        # University Relations Web Communications
        allow from 129.105.24.0/24
        # NUIT Security
        allow from 129.105.46.112/28
        # CI-PIM Admins
        allow from 129.105.214.0/24
        # IPv4 localhost
        allow from 127.0.0.1
        # IPv6 localhost
        allow from ::1
        # Solaris nuinfo/chnuinfo
        allow from 129.105.16.72
        allow from 165.124.67.10
        # cluster web nodes / load-balancer
        allow from 129.105.215.0/24
        allow from 165.124.65.0/24
        # load testing
        allow from 129.105.56.17 129.105.74.67 129.105.74.68 129.105.74.69 129.105.74.70 129.105.74.77 165.124.187.10
        # load testing private address range
        allow from 10.14.34.0/24
        # Nagios groundwork.ci.northwestern.edu
        allow from 129.105.106.28
        # Albert Lunde 3rd party ISP, for testing
        # panix1.panix.com, panix2.panix.com, panix3.panix.com
        allow from 166.84.1.1
        allow from 166.84.1.2
        allow from 166.84.1.3

    </IfDefine>

    # end /nuinfo/httpd/test-ssi
</Directory>

# model for additional directories
#
#<Directory /nuinfo/httpd/xxxx >
#   Options Indexes IncludesNOEXEC FollowSymLinks
#   AllowOverride AuthConfig Limit
#   order allow,deny
#   allow from all
#</Directory>

# was in .htaccess; mostly cosmetic for testing
<Directory /nuinfo/httpd/more-docs/ssi >
    # treat everything in this directry as server-side-includes

    AddType text/html .html
    AddHandler server-parsed .html

    AddType text/html .htm
    AddHandler server-parsed .htm

</Directory>

# for selected directories
# turn on ssi for all HTML files so folks don't have to remember
# to set permissions

<Directory /nuinfo/httpd/htdocs/president >
    # treat everything in this directry as server-side-includes

    AddType text/html .html
    AddHandler server-parsed .html

    AddType text/html .htm
    AddHandler server-parsed .htm

</Directory>

<Directory /nuinfo/httpd/htdocs/tss/troubleshoot >
    # treat everything in this directry as server-side-includes

    AddType text/html .html
    AddHandler server-parsed .html

    AddType text/html .htm
    AddHandler server-parsed .htm

</Directory>

<Directory /nuinfo/httpd/htdocs/it >
    # treat everything in this directry as server-side-includes
    # for Lynne 7/27/99

    AddType text/html .html
    AddHandler server-parsed .html

    AddType text/html .htm
    AddHandler server-parsed .htm

</Directory>

<Directory /nuinfo/httpd/more-docs/itstaff-private/private >
    # treat everything in this directry as server-side-includes
    # for Laurie Rubin 6/21/00

    AddType text/html .html
    AddHandler server-parsed .html

    AddType text/html .htm
    AddHandler server-parsed .htm

</Directory>

# to allow Joe G. to use custom ErrorDocument for WNUR
<Directory /nuinfo/httpd/htdocs/WNUR >
    AllowOverride AuthConfig Limit Fileinfo
</Directory>
<Directory /nuinfo/httpd/htdocs/wnur >
    AllowOverride AuthConfig Limit Fileinfo
</Directory>
#<Location /wnur >
#   AllowOverride is not allowed in Location, Apache 2.2.x reports this
#   AllowOverride AuthConfig Limit Fileinfo
#</Location>

# redirect CGI development host
<Directory /nuinfo/httpd/more-docs/redirect-demo >

# don't Cache results
ExpiresActive Off

# allow "unsafe" stuff not allowed for normal content

AllowOverride All

#AddHandler cgi-script cgi

Options Indexes Includes FollowSymLinks ExecCGI

# pass PATH_INFO to everything
AcceptPathInfo On

</Directory>

# special handlers for system administration

<Location /apache-server-status>
    SetHandler server-status
    # domain _or_ password restricted
    order deny,allow
    deny from all
    # tss static ip subset
    allow from 129.105.188.
    # tss netreg subset
    allow from 129.105.219.
    allow from 129.105.214.
    allow from .tss.northwestern.edu
    allow from bartok.itcs.northwestern.edu
    AuthType Basic
    AuthUserFile /nuinfo/httpd/passwords/proto-htpass
    AuthName "Nuinfo System Administration"
    require valid-user
    satisfy any
</Location>

<Location /apache-server-info>
    SetHandler server-info
    # domain _or_ password restricted
    order deny,allow
    deny from all
    # tss static ip subset
    allow from 129.105.188.
    # tss netreg subset
    allow from 129.105.219.
    allow from 129.105.214.
    allow from .tss.northwestern.edu
    allow from bartok.itcs.northwestern.edu
    # Przemyslaw Krydka IT Portal developer doing load tests 6-11-08
    allow from 129.105.233.18
    AuthType Basic
    AuthUserFile /nuinfo/httpd/passwords/proto-htpass
    AuthName "Nuinfo System Administration"
    require valid-user
    satisfy any
</Location>

# access limits on content directories

<Directory /nuinfo/httpd/htdocs/academic/ctec>

order deny,allow
deny from all
allow from .nwu.edu
allow from .northwestern.edu

</Directory>

#
# mod_proxy directives were here, but we don't want to use it
# because it is a security risk that we don't need
#



# ############# Test directories below ##################

# restricted staff test directory rev 5/14/97, 10/31/97
#  Access limited to staffnet, nuinfo, univ relations,  and selected IP
#  fury.res-hall.nwu.edu was Steven Traykovski <stevent@nwu.edu>
#  chester.res-hall.nwu.edu was Joe Schwab
#  129.105.212.72 is nuinfo
#  ur.northwestern.edu is university relations (added 5/21/98)
#  24.9.207.246 / c542574-c.hlndpk1.il.home.com is Steve DiDomenico <steve@northwestern.edu>

# 10/15/98 add parallel directory /staff-test-html/
# 10/15/98 remove fury.res-hall.nwu.edu no longer in DNS
# 1/21/99 add more refs to tss.nwu.edu, allow access for register,summernu
# reduce use of numeric addresses in anticipation of move
# 5/17/99 further reduce references to subnet 110, add refs to 233
# (network IPs are still there to allow access to AT staff machines)
# 6/25/99 comment out last refs to 110

<Directory /nuinfo/httpd/staff-test-cgi>

    Options Indexes IncludesNOEXEC FollowSymLinks
    # XBitHack full
    AllowOverride AuthConfig FileInfo Indexes

    order deny,allow
    deny from all
    # allow from 129.105.110
    allow from 129.105.233

    # Steve DiDomenico 9/22/00
    allow from 24.9.207.246
    allow from c542574-c.hlndpk1.il.home.com

    allow from nuinfo.northwestern.edu
    allow from ur.northwestern.edu
    allow from tss.northwestern.edu

    # subnet with UR Web communications
    allow from 129.105.24.0/24

    # tss static ip subset
    allow from 129.105.188.
    # tss netreg subset
    allow from 129.105.219.

    # Adam Findlayson wcas 2-7-07
    allow from zero.wcas.northwestern.edu
    allow from 105.29.249.229

    # end /nuinfo/httpd/staff-test-cgi
</Directory>


# this should be a clone of the setup for the main document
# root except for access restrictions
<Directory /nuinfo/httpd/staff-test-html >

    # This may also be "None", or any combination of "Indexes",
    # "Includes", or "FollowSymLinks"

    # Options All
    # changed 6/24/96 to be more paranoid
    Options Indexes IncludesNOEXEC FollowSymLinks

    # allow XBitHack to turn on server side includes
    # XBitHack full

    # This controls which options the .htaccess files in directories can
    # override. Can also be "None", or any combination of "Options", "FileInfo",
    # "AuthConfig", and "Limit"

    AllowOverride AuthConfig Limit

    # Controls who can get stuff from this server.

    order deny,allow
    deny from all
    # allow from 129.105.110
    allow from 129.105.233

    # Steve DiDomenico 9/22/00
    allow from 24.9.207.246
    allow from c542574-c.hlndpk1.il.home.com

    allow from nuinfo.nwu.edu
    allow from ur.nwu.edu
    allow from tss.nwu.edu

    allow from nuinfo.northwestern.edu
    allow from ur.northwestern.edu
    allow from tss.northwestern.edu

    # subnet with UR Web communications
    allow from 129.105.24.0/24

    # tss static ip subset
    allow from 129.105.188.
    # tss netreg subset
    allow from 129.105.219.

    # Adam Findlayson wcas 2-7-07
    allow from zero.wcas.northwestern.edu
    allow from 105.29.249.229

    # end /nuinfo/httpd/staff-test-html
</Directory>

# Lunde test directory for mixed HTML and CGI content

<Directory /nuinfo/httpd/staff-test-html/lunde/mixed >

# DO NOT USE ExecCGI IN ANY PRODUCTION DIRECTORIES ON NUINFO
Options Indexes IncludesNOEXEC FollowSymLinks ExecCGI
# XBitHack full
# AllowOverride AuthConfig Limit
AllowOverride All

# DO NOT USE DIRECTIVE THIS IN ANY PRODUCTION DIRECTORIES ON NUINFO
AddHandler cgi-script cgi

# Like Aquavite
DirectoryIndex index.html index.htm home.html home.htm index.cgi

# Rewrite rules to fake out URLs
#RewriteEngine on
#RewriteOptions inherit
# This causes an infinite loop! but may be close to a real answer
#RewriteBase /staff-test-html/lunde/mixed
#RewriteRule ^secure(.*)    secure/index.cgi/$1     [L,NS]
#RewriteRule ^test(.*)  test.cgi/$1             [L,NS]
#RewriteRule ^(.*)      index.cgi/$1            [L,NS]


# Controls who can get stuff from this server.

order deny,allow
deny from all
allow from nuinfo.nwu.edu
#allow from ur.nwu.edu
allow from tss.nwu.edu

allow from nuinfo.northwestern.edu
#allow from ur.northwestern.edu
allow from tss.northwestern.edu

</Directory>


<Directory /nuinfo/httpd/staff-test-cgi/tmazza/secure>

# Ted's passwd auth test directory

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride All

order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from tss.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu

</Directory>

<Directory /nuinfo/httpd/staff-test-cgi/jschwab>

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride All

order mutual-failure
# deny from all
allow from .nwu.edu
allow from .northwestern.edu

allow from 129.105.233

allow from nuinfo.nwu.edu
allow from ur.nwu.edu
allow from tss.nwu.edu

allow from nuinfo.northwestern.edu
allow from ur.northwestern.edu
allow from tss.northwestern.edu

# keep out res-halls, labs
deny from res-hall.nwu.edu
deny from at.nwu.edu

deny from res-hall.northwestern.edu
deny from at.northwestern.edu

</Directory>


<Directory /nuinfo/httpd/staff-test-cgi/jschwab/secure>

# Joe's passwd auth test directory

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride All

order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from tss.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu

</Directory>

<Directory /nuinfo/httpd/staff-test-cgi/lunde/passtest>

# Albert Lunde passwd auth test directory

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride All

order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from tss.nwu.edu
allow from ur.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu
allow from ur.northwestern.edu

</Directory>

<Directory /nuinfo/httpd/staff-test-cgi/lunde/switch>

# Albert Lunde breaking news test directory

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride All

order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from ur.nwu.edu
allow from tss.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu
allow from ur.northwestern.edu

</Directory>

<Directory /nuinfo/httpd/staff-test-cgi/lunde/breaking-news >
    # new breaking news test with passport auth
    Options Indexes IncludesNOEXEC FollowSymLinks
    AllowOverride All

    order deny,allow
    deny from all

    allow from tss.northwestern.edu
</Directory>

<Directory /nuinfo/httpd/staff-test-cgi/lunde/breaking-static >
    # new breaking news test with static pw auth
    Options Indexes IncludesNOEXEC FollowSymLinks
    AllowOverride All

    AuthType Basic
    AuthUserFile /nuinfo/httpd/passwords/brnews2-htpass
    AuthName "Breaking News Prototype"

    order deny,allow

    deny from all
    allow from tss.northwestern.edu


    require valid-user
    satisfy All

</Directory>

<Directory /nuinfo/httpd/staff-test-cgi/summernu>

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride None

order deny,allow
deny from all
# test dir for David Parrish summernu 4/17/96
# expanded to allow access from all of ed.nwu.edu 1/21/99

allow from nuinfo.nwu.edu
allow from tss.nwu.edu
allow from ed.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu
allow from ed.northwestern.edu

</Directory>

<Directory /nuinfo/httpd/staff-test-html/summernu>

order deny,allow
deny from all
# test html dir for summernu

allow from nuinfo.nwu.edu
allow from tss.nwu.edu
allow from ed.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu
allow from ed.northwestern.edu

</Directory>


<Directory /nuinfo/httpd/staff-test-cgi/register >

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride None

# test cgi dir for Registrar/Tamara
order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from ur.nwu.edu
allow from tss.nwu.edu
allow from registrar.nwu.edu
# Tamara Foster
allow from isdn216046.isdn.nwu.edu
allow from norge.crown.nwu.edu

allow from nuinfo.northwestern.edu
allow from ur.northwestern.edu
allow from tss.northwestern.edu
allow from registrar.northwestern.edu
# Tamara Foster
allow from isdn216046.isdn.northwestern.edu
allow from norge.crown.northwestern.edu

</Directory>

<Directory /nuinfo/httpd/staff-test-html/register >

# test html for Registrar/Tamara
order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from ur.nwu.edu
allow from tss.nwu.edu
allow from registrar.nwu.edu
# Tamara Foster
allow from isdn216046.isdn.nwu.edu
allow from norge.crown.nwu.edu

allow from nuinfo.northwestern.edu
allow from ur.northwestern.edu
allow from tss.northwestern.edu
allow from registrar.northwestern.edu
# Tamara Foster
allow from isdn216046.isdn.northwestern.edu
allow from norge.crown.northwestern.edu

</Directory>


<Directory /nuinfo/httpd/staff-test-cgi/gsd944 >

Options Indexes IncludesNOEXEC FollowSymLinks
# XBitHack full
AllowOverride None

# test cgi dir for Graduade School Dean/gsd944/Dan McCoy
order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from tss.nwu.edu
allow from gsa-orsp.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu
allow from gsa-orsp.northwestern.edu

</Directory>


<Directory /nuinfo/httpd/staff-test-html/gsd944 >

# test html for Graduade School Dean/gsd944/Dan McCoy
order deny,allow
deny from all

allow from nuinfo.nwu.edu
allow from tss.nwu.edu
allow from gsa-orsp.nwu.edu

allow from nuinfo.northwestern.edu
allow from tss.northwestern.edu
allow from gsa-orsp.northwestern.edu

</Directory>

<Directory /nuinfo/httpd/staff-test-cgi/mrj666 >

# test CGI for mrj666 Michael R Johnson - University Relations student
        order deny,allow
        deny from all

        allow from .tss.nwu.edu
        allow from .ur.nwu.edu
        allow from nuinfo.nwu.edu
        allow from .tss.northwestern.edu
        allow from .ur.northwestern.edu
        allow from nuinfo.northwestern.edu

        AuthType Basic
        AuthUserFile /nuinfo/httpd/passwords/ur-student-htpass
        AuthName "Staff Test Prototype"
        require valid-user
        satisfy any

</Directory>

<Directory /nuinfo/httpd/staff-test-html/mrj666 >

# test html for mrj666 Michael R Johnson - University Relations student
        order deny,allow
        deny from all

        allow from .tss.nwu.edu
        allow from .ur.nwu.edu
        allow from nuinfo.nwu.edu
        allow from .tss.northwestern.edu
        allow from .ur.northwestern.edu
        allow from nuinfo.northwestern.edu

        AuthType Basic
        AuthUserFile /nuinfo/httpd/passwords/ur-student-htpass
        AuthName "Staff Test Prototype"
        require valid-user
        satisfy any

</Directory>
#
<IfModule mod_perl.c>

PerlModule Apache::Registry

# Apache::Registry directives we want to apply everywhere possible
PerlTaintCheck On
PerlFreshRestart On

#PerlRequire Apache::Status
# # perl module status
#<Location /apache-perl-info>
#
#   SetHandler perl-script
#   PerlHandler Apache::Status
#
#   # domain _or_ password restricted
#   order deny,allow
#   deny from all
#   allow from .tss.nwu.edu
#   allow from .tss.northwestern.edu
#   allow from .ur.nwu.edu
#   allow from .ur.northwestern.edu
#   allow from bartok.ucc.nwu.edu
#   allow from bartok.ucc.northwestern.edu
#   AuthType Basic
#   AuthUserFile /nuinfo/httpd/passwords/proto-htpass
#   AuthName "Nuinfo System Administration"
#   require valid-user
#   satisfy any
#
#</Location>

# end mod_perl
</IfModule>
#
# blocking TRACE for possible security issue 1-24-03
RewriteEngine on
RewriteCond %{REQUEST_METHOD}  !^(GET|POST|HEAD|OPTIONS)$
RewriteRule .* - [F]
#

# we don't need TRACE turn it off 2-17-2010
TraceEnable off

# global test directory for websso policy checking
Alias /test-websso-auth-dir/    /nuinfo/httpd/more-docs/test-websso-auth-dir/
Alias /test-websso-auth-dir     /nuinfo/httpd/more-docs/test-websso-auth-dir/

<Location /test-websso-auth-dir >
    order deny,allow
    deny from all
    # allow access from selected test address
    # but not the world at large
    allow from 129.105.233
    allow from 129.105.16.72
    allow from 165.124.67.10
    allow from .itcs.northwestern.edu
    allow from .it.northwestern.edu
    allow from .tss.northwestern.edu
    allow from .ur.northwestern.edu
</Location>

# - - - - -

# define Sun agent on if NOAGENT is not defined
# I use a negative condition for security: to "fail closed"
<IfDefine !NOAGENT>
# enable Sun Web Access Manager module

<IfDefine !CLUSTER>
    <IfDefine !MIRROR>
    # main host / nuinfo

    <IfDefine !TESTSERVER>
        # production port 80
        # This include loads a module and references a particular instance of Sun WAM
        include /etc/opt/SUNWam/agents/apache/config/_prod/dsame.conf
        # Its configuration is found in
        # /etc/opt/SUNWam/agents/apache/config/_prod/AMAgent.properties
    </IfDefine>

    <IfDefine TESTSERVER>
        # test port 8002
        # This include loads a module and references a particular instance of Sun WAM
        include /etc/opt/SUNWam/agents/apache/config/_test/dsame.conf
        # Its configuration is found in
        # /etc/opt/SUNWam/agents/apache/config/_test/AMAgent.properties
    </IfDefine>

    # end if main host
    </IfDefine>

    <IfDefine MIRROR>
        # mirror host / chnuinfo

        <IfDefine !TESTSERVER>
            # mirror production port 80
            # This include loads a module and references a particular instance of Sun WAM
            include /etc/opt/SUNWam/agents/apache/config/_prod/dsame.conf
            # Its configuration is found in
            # /etc/opt/SUNWam/agents/apache/config/_prod/AMAgent.properties
        </IfDefine>

        <IfDefine TESTSERVER>
            # mirror production port 8002
            # This include loads a module and references a particular instance of Sun WAM
            include /etc/opt/SUNWam/agents/apache/config/_test/dsame.conf
            # Its configuration is found in
            # /etc/opt/SUNWam/agents/apache/config/_test/AMAgent.properties
        </IfDefine>

        # end if mirror host
    </IfDefine>

# end if not cluster
</IfDefine>

<IfDefine CLUSTER>
    <IfDefine !TESTSERVER>
        # cluster production host, port 80, Agent_001

        # This include loads a module and references a particular instance of Sun WAM
        include /var/local/web_agents/apache22_agent/Agent_001/config/dsame.conf

        # Its configuration is found in
        # include /var/local/web_agents/apache22_agent/Agent_001/config/AMAgent.properties

    </IfDefine>

    <IfDefine TESTSERVER>
        # cluster test host, port 8002, Agent_002

        # This include loads a module and references a particular instance of Sun WAM
        include /var/local/web_agents/apache22_agent/Agent_002/config/dsame.conf

        # Its configuration is found in
        # include /var/local/web_agents/apache22_agent/Agent_002/config/AMAgent.properties

    </IfDefine>

    # end if cluster
</IfDefine>


# end if !NOAGENT
</IfDefine>

# - - - - -

#

